<apex:page showHeader="false" sidebar="false" controller="CustomDocumentController">
<apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" />

 
 <iframe id="vfFrame" style="border: none;min-width:600px;width: 100%;height: 80vh;" src="/fintech/s/contentdocument/{ID}"/>
 
 <script>
    var fileId;
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    fileId= vars["id"];
    
    document.getElementById("vfFrame").onload = function() {
        myLoop();
    };
    
    function myLoop () {          
       setTimeout(function () {   
          try {
               var iframe = document.getElementById("vfFrame");
                var elmnt = iframe.contentWindow.document.getElementsByClassName('showPreviewButton')[0].click();
         }catch(e){
             myLoop();            
          }                      
       }, 50)
    }

    
    $("#vfFrame").attr("src", "/fintech/s/contentdocument/" + fileId);
    
 $(window).load(function () {
     
 var frame = $('iframe').get(0);
    if (frame != null) {
        var frmHead = $(frame).contents().find('head');
        if (frmHead != null) {
           frmHead.append('<style type="text/css">.top, .slds-size_1-of-1, header, .cHeaderPanel, .uiTabBar, .forceCommunityFileDetailPage .forceRelatedListContainer{display:none !important;} .cViewPanel, html{background: white;} .page.loaded {margin-top: 0px !important;} </style>');
        }
    } 
 }); 

</script>

</apex:page>