(window._walkmeABWebpackJP_latest=window._walkmeABWebpackJP_latest||[]).push([[3],{106:function(e,t,n){"use strict";(function(e,r,a,o){function i(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateWMSearchSuggestions=t.updateWMSearchSuggestionsSuccess=t.getRestSuggestions=t.getNextSuggestions=t.clearSuggestions=t.restoreCurrentNodeSuggestions=t.setInitialSuggestions=t.getSuggestionsSuccess=t.handleStaticSuggestions=void 0;var u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=i(n(33)),d=i(n(78)),l=i(n(79)),f=n(41),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),v=n(21),g=t.handleStaticSuggestions=function(e){var t=(0,c.default)(e,["settings","mergeType"],""),n=(0,c.default)(e,["settings","separatorText"],""),r=(0,c.default)(e,["settings","sortRecordsBy","type"])?1:-1,a=new Set(e.suggestions),o=f.suggestionsSorter.bind(void 0,r),i=(0,f.mapSuggestions)(e.staticSuggestions,t!==v.SUGGESTION_MERGE_TYPES.merged?v.SUGGESTION_TYPES.staticSuggestion:null).filter(function(e){return!a.has(e.displayName)}).sort(o),s={id:v.SUGGESTIONS_SEPARATOR_ID,displayName:n,type:v.SUGGESTION_TYPES.separator},u=(0,f.mapSuggestions)(e.suggestions),d=n&&i.length&&u.length?[s]:[];switch(t){case v.SUGGESTION_MERGE_TYPES.top:return i.concat(d,u);case v.SUGGESTION_MERGE_TYPES.bottom:return u.concat(d,i);case v.SUGGESTION_MERGE_TYPES.merged:return u.concat(i).sort(o);default:return l.default.error(new Error("Unknown static suggestion merge type: "+t)),u}},h=t.getSuggestionsSuccess=function(e){return{type:p.GET_SUGGESTIONS_SUCCESS,payload:{suggestions:e}}},S=(t.setInitialSuggestions=function(e,t){return function(n,r){var o=r().settings,i=t||o.conversations,s=(e||o.suggestedConversations).reduce(function(e,t){var n=i.find(function(e){return e.id===t});return n?[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}(e),[u({},n,{type:v.SUGGESTION_TYPES.conversation})]):e},[]);n(h(s))}},t.restoreCurrentNodeSuggestions=function(){return function(e,t){var n=t().conversation.currentNode;n&&e(h(n.staticSuggestions?g(n):(0,f.mapSuggestions)(n.suggestions)))}},t.clearSuggestions=function(){return function(e){return e(h([]))}},t.getNextSuggestions=function(e,t){if(!t)return[];var n=(0,f.mapSuggestions)(t);return(0,c.default)(e,"staticSuggestions",[]).length?g(e):n}),y=(t.getRestSuggestions=function(e){return t=s(o.mark(function t(n,r){var a,i,s,u,v,g,y;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r(),i=a.dialog,t.prev=1,n({type:p.GET_REST_SUGGESTIONS_START}),t.next=5,d.default.getRestSuggestions(i.botId,i.conversationId,i.id,e);case 5:if(s=t.sent.data,u=r(),v=(0,c.default)(u,["conversation","currentNode"]),g=(0,c.default)(v,"id"),!(0,f.hasBotChanged)(u,i.botId)&&e===g){t.next=12;break}return t.abrupt("return");case 12:y=S(v,s),n(h(y)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),l.default.error(t.t0);case 19:case"end":return t.stop()}},t,void 0,[[1,16]])})),function(){return t.apply(this,arguments)};var t},t.updateWMSearchSuggestionsSuccess=function(e){return{type:p.GET_WM_SEARCH_SUGGESTIONS_SUCCESS,payload:{wmSearchItems:e}}});t.updateWMSearchSuggestions=function(e){return t=s(o.mark(function t(n){var r;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:p.GET_WM_SEARCH_SUGGESTIONS_START}),r=[],e){t.next=8;break}return t.next=5,(0,f.getInitialWMSearchResult)();case 5:r=t.sent,t.next=11;break;case 8:return t.next=10,(0,f.getWMSearchResult)(e);case 10:r=t.sent;case 11:return t.abrupt("return",n(y(r)));case 12:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t}}).call(this,n(4).assign,n(18).Promise,n(38).from,n(35))},125:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.closeChatWindow=t.changeFocusInput=t.changeBotStatus=t.changeInsideFormState=void 0;var r,a=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(67),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),s=n(21),u=n(78),c=(r=u)&&r.__esModule?r:{default:r};t.changeInsideFormState=function(e){return{type:i.INSIDE_FORM,payload:{insideForm:e}}},t.changeBotStatus=function(e){return{type:i.BOT_STATUS,payload:{isBotThinking:e}}},t.changeFocusInput=function(e){return{type:i.CHANGE_INPUT_FOCUS,payload:{isBotWaitForAnswer:e}}},t.closeChatWindow=function(){return function(e,t){var n=t();(0,o.sendWalkMeMessage)({type:i.BOT_CLOSE});var r=n.settings,u={type:"actionBotBot",oId:r.botId,oName:r.name};if(n.dialog&&n.dialog.id&&n.conversation.currentNode&&!r.additionalSettings.playMode){var d=n.conversation.currentNode;(0,o.sendAnalyticsEvent)(s.ANALYTICS_EVENTS.chatClosed,a({},u,{pId:n.dialog.id,aAppType:d.type,aoId:d.id,aoName:d.name}))}else(0,o.sendAnalyticsEvent)(s.ANALYTICS_EVENTS.chatClosed,u);e({type:i.FLUSH_STORE}),c.default.cancelAllRequests("Chat window closed")}}}).call(this,n(4).assign)},126:function(e,t,n){"use strict";(function(e,r){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});"function"==typeof Symbol&&Symbol;var o=n(180),i=a(n(413)),s=a(n(414)),u=a(n(448)),c=a(n(79)),d=(0,o.createStore)(s.default,(0,o.compose)((0,o.applyMiddleware)(i.default,function(){return function(t){return n=r.mark(function e(n){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",t(n));case 4:e.prev=4,e.t0=e.catch(0),c.default.error(e.t0);case 7:case"end":return e.stop()}},e,void 0,[[0,4]])}),a=function(){var t=n.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})},function(){return a.apply(this,arguments)};var n,a}})));(0,u.default)(d),t.default=d}).call(this,n(18).Promise,n(35))},152:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.initSession=t.initSessionFail=t.initSessionSuccess=t.loadBotData=t.resolveBBCodesInBotData=t.getBotDataRequireBBCodesResolve=t.getBotConversationsFail=t.getBotAllConversationsSuccess=t.getBotConversationsSuccess=t.getBotDataFail=t.getBotDataSuccess=void 0;var s,u=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=o(n(33)),l=o(n(78)),f=n(316),p=n(67),v=o(n(79)),g=n(41),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),S=n(153),y=n(125),_=n(106),m=n(156),E=t.getBotDataSuccess=function(e){return{type:h.GET_BOT_DATA_SUCCESS,payload:{settings:e,addInitialMessageToChat:1>=arguments.length||void 0===arguments[1]||arguments[1]}}},I=t.getBotDataFail=function(e){return{type:h.GET_BOT_DATA_FAIL,payload:{error:e}}},T=t.getBotConversationsSuccess=function(e){return{type:h.GET_BOT_CONVERSATIONS_SUCCESS,payload:{conversations:e}}},b=t.getBotAllConversationsSuccess=function(e){return{type:h.GET_BOT_ALL_CONVERSATIONS_SUCCESS,payload:{allConversations:e}}},w=t.getBotConversationsFail=function(e){return{type:h.GET_BOT_CONVERSATIONS_FAIL,payload:{error:e}}},C=t.getBotDataRequireBBCodesResolve=function(e){return e?["initialMessages","doneText","noConversationsOneSearchItemFoundText","noMatchedConversationErrorMessages","severalConversationsFoundText"].reduce(function(t,n){return e.hasOwnProperty(n)?c({},t,(o=e[n],(a=n)in(r={})?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,r)):t;var r,a,o},{}):{}},x=t.resolveBBCodesInBotData=(s=i(a.mark(function e(t){var n,r;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",t);case 2:return n=C(t),e.next=5,(0,g.resolveBBCodes)(JSON.stringify(n));case 5:return r=e.sent,e.prev=6,e.abrupt("return",JSON.parse(r));case 10:return e.prev=10,e.t0=e.catch(6),v.default.error(e.t0,!0),e.abrupt("return",t);case 14:case"end":return e.stop()}},e,void 0,[[6,10]])})),function(){return s.apply(this,arguments)}),N=(t.loadBotData=function(t){var n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],C=3>=arguments.length||void 0===arguments[3]||arguments[3];return n=i(a.mark(function n(i,N){var A,O,k,M,D,B,R,L,U,P,F,G,W,V,j,Y,H,z;return a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return l.default.setNewCancelToken(),(o||s)&&i((0,y.changeBotStatus)(!0)),n.prev=2,n.next=5,r.all([l.default.fetchBotData(t),l.default.getConversations(t)]);case 5:return A=u(n.sent,2),O=A[0],k=A[1],n.next=11,x(O.data);case 11:if(e(O.data,c({},n.sent)),!O.data.hasOwnProperty("initialMessages")){n.next=17;break}return n.next=16,r.all(O.data.initialMessages.map(function(e){return(0,g.resolveBBCodes)(e)}));case 16:O.data.initialMessages=n.sent;case 17:if(M=N(),!(0,g.hasBotChanged)(M,t)){n.next=20;break}return n.abrupt("return");case 20:return D=M.settings.conversationId,n.next=23,(0,f.filterConversationsByTags)(k.data);case 23:if(i(b(B=n.sent)),!D){n.next=31;break}return n.next=28,l.default.getConversation(t,D);case 28:B=[n.sent.data];case 31:if(R=(0,d.default)(M,["settings","additionalSettings"],{}),L=R.playMode,U=R.previewEntityType,P=(0,d.default)(O,["data","botCustomStyles"],[]).find(function(e){return e.active}),F=(0,d.default)(P,"css",""),o?(0,g.applyStyles)(F):C&&(0,p.sendWalkMeMessage)({type:h.BOT_SHOW}),i(T(B)),!o||L){n.next=39;break}return n.abrupt("return",i((0,S.tryRestoreDialog)(O.data,B)));case 39:if(G=1===B.length,W=L&&"bot"===U,V=s&&!G||W&&(s||o),j=(0,d.default)(M,["settings","singleConversationPlayed"],!1),i(E(O.data,V)),H=[],!(Y=O.data).isWalkMeSearchEnabled||!Y.isWalkMeSearchItemsSuggestedInitially){n.next=51;break}return n.next=49,i((0,_.updateWMSearchSuggestions)());case 49:H=(0,d.default)(n.sent,["payload","wmSearchItems"],[]);case 51:!G||H.length||W||j&&!s&&!o?(i((0,_.setInitialSuggestions)(O.data.suggestedConversations,B)),i((0,y.changeBotStatus)(!1))):i((0,m.chooseConversation)(B[0],!0)),n.next=64;break;case 54:if(n.prev=54,n.t0=n.catch(2),!l.default.isCanceled(n.t0)){n.next=58;break}return n.abrupt("return");case 58:(0,p.sendWalkMeMessage)({type:h.INITIAL_DATA_LOAD_FAIL}),z=(0,d.default)(n.t0,["response","data"],{}),(0,d.default)(n.t0,["config","url"],"").includes("conversations")?i(w(z)):i(I(z)),i((0,y.changeBotStatus)(!1)),v.default.error(n.t0,!1);case 64:case"end":return n.stop()}},n,void 0,[[2,54]])})),function(){return n.apply(this,arguments)}},t.initSessionSuccess=function(e,t,n,r){return(0,p.sendWalkMeMessage)({type:h.INIT_SESSION_SUCCESS,payload:{uuid:t}}),{type:h.INIT_SESSION_SUCCESS,payload:{jwt:e,uuid:t,siteConfig:n,globalConfig:r}}}),A=t.initSessionFail=function(e){return(0,p.sendWalkMeMessage)({type:h.INIT_SESSION_FAIL}),{type:h.INIT_SESSION_FAIL,payload:{error:e}}};t.initSession=function(e,t,n,r,o,s){return u=i(a.mark(function i(u){var f,p,g,h;return a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,l.default.fetchJWT(c({clientSideSFOauth:s,userGuid:e,walkmeEndUserId:t},n&&{uuid:n}));case 3:g=(f=a.sent.data).uuid,(p=f.jwt)&&g&&u(N(p,g,r,o)),a.next=15;break;case 10:a.prev=10,a.t0=a.catch(0),h=(0,d.default)(a.t0,["response","data"]),u(A(h)),v.default.error(a.t0);case 15:case"end":return a.stop()}},i,void 0,[[0,10]])})),function(){return u.apply(this,arguments)};var u}}).call(this,n(4).assign,n(18).Promise,n(35))},153:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.finishCurrentDialog=t.finishCurrentDialogFail=t.finishCurrentDialogSuccess=t.removeAnswer=t.removeAnswerFail=t.removeAnswerSuccess=t.tryRestoreDialog=t.startOver=t.restoreDialogFail=t.restoreDialogSuccess=t.truncateCurrentDialogData=t.addCurrentDialogData=t.createDialog=t.createDialogSuccess=void 0;var s=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=o(n(33)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),l=o(n(78)),f=o(n(317)),p=n(67),v=o(n(79)),g=n(41),h=n(21),S=n(68),y=n(156),_=n(154),m=n(152),E=n(125),I=n(106),T=n(234),b=t.createDialogSuccess=function(e){return{type:d.CREATE_DIALOG_SUCCESS,payload:{dialog:u({},e,{isRestored:arguments.length>1&&void 0!==arguments[1]&&arguments[1]})}}},w=(t.createDialog=function(){return e=i(a.mark(function e(t,n){var r,o,i,s,u,d,p;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=n(),s=(i=r.settings).botId,u=i.envId,d=(0,c.default)(o=r.conversation.picked,h.CLIENT_SIDE_MODE,!1),s){e.next=5;break}return e.abrupt("return");case 5:if(p=void 0,!d){e.next=10;break}p=f.default.createLocalDialog({botId:s,conversationId:o.id,envId:u}),e.next=15;break;case 10:return e.next=12,l.default.createDialog(s,o.id);case 12:p=e.sent.data;case 15:if(!(0,g.hasBotChanged)(n(),s)){e.next=17;break}return e.abrupt("return");case 17:t(b(p)),t((0,y.getFirstConversationNode)()),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),t((0,T.handleError)(e.t0));case 24:case"end":return e.stop()}},e,void 0,[[0,21]])})),function(){return e.apply(this,arguments)};var e},t.addCurrentDialogData=function(e){return{type:d.DIALOG_DATA_ADDED,payload:{data:e}}},t.truncateCurrentDialogData=function(e){return{type:d.DIALOG_TRUNCATE_DATA_SEQUENCE,payload:{dataKey:e}}}),C=t.restoreDialogSuccess=function(e,t,n){return{type:d.RESTORE_DIALOG_SUCCESS,payload:{messages:e,defaultLabels:t,mentionData:n}}},x=t.restoreDialogFail=function(e){return{type:d.RESTORE_DIALOG_FAIL,payload:{error:e}}},N=t.startOver=function(){return e=i(a.mark(function e(t,n){var r,o,i,s,u,c,d,l;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n(),i=(o=r.settings).botId,s=o.separatorNewText,c=(u=r.conversation).picked,d=u.currentNode,(l=r.dialog)&&c&&d&&(0,p.sendAnalyticsEvent)(h.ANALYTICS_EVENTS.conversationEnded,{oId:c.id,oName:c.name,pId:l.id,aAppType:d.type,aoId:d.id,aoName:d.name,seekTime:(0,g.getConversationDuration)(r.conversation.conversationStarted),total:r.conversation.conversationLength,reason:2,type:"actionBotConversation",owName:r.settings.name,pInit:{id:i,type:S.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}}),e.prev=3,e.next=6,t((0,y.finishConversation)(!1,!1,!1));case 6:t((0,m.loadBotData)(i,!1,!0)),t((0,_.addSeparator)(s||h.DEFAULT_LABELS.separatorNewText,!0)),t((0,E.changeFocusInput)(!0)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),v.default.error(e.t0);case 14:case"end":return e.stop()}},e,void 0,[[3,11]])})),function(){return e.apply(this,arguments)};var e},A=(t.tryRestoreDialog=function(e,t){return n=i(a.mark(function n(o,i){var u,f,S,T,w,A,O,k,M,D,B,R,L,U,P,F,G,W,V,j,Y,H,z,q,K,Q,X,J,Z,$,ee,te,ne;return a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,u=(0,c.default)(i(),["settings","conversationId"]),f=new r(function(t,n){l.default.restoreDialog(e.id,u).then(function(e){t(e)}).catch(function(e){n(e)})}),n.next=5,f;case 5:if(T=(S=n.sent).data,w=S.status,A=i(),!(0,g.hasBotChanged)(A,e.id)){n.next=11;break}return n.abrupt("return");case 11:if(204!==w){n.next=27;break}if(O=1===t.length,k=(0,c.default)(A,["settings","additionalSettings"],{}),M=k.playMode&&"bot"===k.previewEntityType,D=[],!e.isWalkMeSearchEnabled||!e.isWalkMeSearchItemsSuggestedInitially){n.next=22;break}return n.next=20,o((0,I.updateWMSearchSuggestions)());case 20:D=(0,c.default)(n.sent,["payload","wmSearchItems"],[]);case 22:return!O||D.length||M?(o((0,m.getBotDataSuccess)(e)),o((0,I.setInitialSuggestions)(e.suggestedConversations,t))):(B=s(t,1),R=B[0],o((0,m.getBotDataSuccess)(e,!1)),o((0,y.chooseConversation)(R))),o((0,E.changeBotStatus)(!1)),L=(0,c.default)(i(),["messages","0","text"],""),(0,p.sendAnalyticsEvent)(h.ANALYTICS_EVENTS.chatOpened,{type:"actionBotBot",oId:e.id,oName:e.name,value:L}),n.abrupt("return");case 27:if(U=T.id,P=T.conversationId,G=T.data,!(F=T.sequence)){n.next=73;break}if(W=A.settings.conversations.find(function(e){return e.id===P}),V=F[F.length-1]||{},!W){n.next=73;break}if(j=V.id,Y=V.name,H=V.type,z=V.suggestions,q=V.dataType,K={botId:e.id,conversationId:P,data:{},id:U},Q={today:e.separatorTodayText||h.DEFAULT_LABELS.separatorTodayText,yesterday:e.separatorYesterdayText||h.DEFAULT_LABELS.separatorYesterdayText},o((0,y.chooseConversation)(W,!1)),o(b(K,!0)),W.isForm&&F.length>0&&(F[F.length-1].isForm=!0,F[F.length-1].form=W.form,o((0,E.changeInsideFormState)(!0))),o(C(F,Q,G)),o((0,E.changeBotStatus)(!1)),!F.length){n.next=71;break}if(o((0,y.getConversationNodeSuccess)(V)),X=V.nextConversationNodeId,H&&"message"!==H){n.next=52;break}if(!X){n.next=50;break}o((0,_.getNextConversationNode)(X)),n.next=52;break;case 50:return n.next=52,o((0,y.finishConversation)());case 52:if("question"===H&&(0,g.nodeHasSuggestions)(V)&&(o((0,I.getSuggestionsSuccess)((0,I.getNextSuggestions)(V,z))),q===h.SALESFORCE_QUESTION_TYPE&&z.length===h.MIN_SUGGESTIONS_CHUNK_SIZE&&o((0,I.getRestSuggestions)(j))),"action"!==H){n.next=69;break}return J=(0,c.default)(V,["settings","app"]),Z=(0,c.default)(V,["settings","id"]),n.next=58,(0,p.sendWalkMeMessage)({type:d.GET_APP_STARTED_FLAG,payload:{app:J,id:Z}});case 58:if(!n.sent){n.next=68;break}if(!X){n.next=64;break}o((0,_.getNextConversationNode)(X)),n.next=66;break;case 64:return n.next=66,o((0,y.finishConversation)());case 66:n.next=69;break;case 68:o((0,y.processConversationNode)(V,U));case 69:n.next=72;break;case 71:o((0,y.getFirstConversationNode)());case 72:(0,p.sendAnalyticsEvent)(h.ANALYTICS_EVENTS.chatOpened,{type:"actionBotBot",oId:e.id,oName:e.name,pId:U,aType:"Restored",aAppType:H,aoId:j,aoName:Y});case 73:o((0,m.getBotDataSuccess)(e,!1)),n.next=85;break;case 76:if(n.prev=76,n.t0=n.catch(0),!l.default.isCanceled(n.t0)){n.next=80;break}return n.abrupt("return");case 80:o(x(n.t0)),o((0,E.changeBotStatus)(!1)),$=e.conversationUnpublishedText,ee=e.conversationUpdatedText,n.t0&&n.t0.message!==h.RESTORE_DIALOG_TIMEOUT&&(te=(0,c.default)(n.t0,["response","data","reason"],""),ne=h.DEFAULT_ERROR_MESSAGE,te?("WRONG_DATA"===te.version&&(ne=ee||h.DEFAULT_LABELS.conversationUpdatedText),"NOT_PUBLISHED"!==te.published&&"WRONG_ID"!==te.conversationId||(ne=$||h.DEFAULT_LABELS.conversationUnpublishedText),"NOT_ASSIGNED"===te.conversationId&&(ne=h.DEFAULT_ERROR_MESSAGE)):v.default.error(n.t0),o((0,_.addMessageToChat)(ne))),o(N());case 85:case"end":return n.stop()}},n,void 0,[[0,76]])})),function(){return n.apply(this,arguments)};var n},t.removeAnswerSuccess=function(e,t){return{type:d.REMOVE_ANSWER_SUCCESS,payload:{id:e,nodeId:t}}}),O=t.removeAnswerFail=function(e){return{type:d.REMOVE_ANSWER_FAIL,payload:{error:e}}},k=(t.removeAnswer=function(e,t){return n=i(a.mark(function n(r,o){var i,s,u,d,f,p;return a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,i=o(),s=i.settings.botId,d=i.dialog,f=(0,c.default)(u=i.conversation.picked,h.CLIENT_SIDE_MODE,!1),p=(0,c.default)(u,h.IS_FORM,!1),!(s&&u&&d)){n.next=16;break}if(!f&&!p){n.next=9;break}r(w(e)),n.next=11;break;case 9:return n.next=11,l.default.removeAnswer(s,u.id,d.id,e);case 11:if(!(0,g.hasBotChanged)(o(),s)){n.next=13;break}return n.abrupt("return");case 13:r((0,I.clearSuggestions)()),r(A(e,t)),r((0,_.getNextConversationNode)(t));case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(0),r(O(n.t0)),v.default.error(n.t0);case 22:case"end":return n.stop()}},n,void 0,[[0,18]])})),function(){return n.apply(this,arguments)};var n},t.finishCurrentDialogSuccess=function(){return{type:d.FINISH_CURRENT_DIALOG_SUCCESS}}),M=t.finishCurrentDialogFail=function(e){return{type:d.FINISH_CURRENT_DIALOG_FAIL,payload:{error:e}}};t.finishCurrentDialog=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e=i(a.mark(function e(n,r){var o,i,s,u,f,S;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=r(),i=o.settings.botId,u=o.dialog,f=(0,c.default)(s=o.conversation.picked,h.CLIENT_SIDE_MODE,!1),S=(0,c.default)(s,h.IS_FORM,!1),!(i&&s&&u)){e.next=12;break}if(f&&S){e.next=8;break}return e.next=8,l.default.finishDialog(i,s.id,u.id);case 8:if(!(0,g.hasBotChanged)(r(),i)){e.next=10;break}return e.abrupt("return");case 10:n(k()),t&&((0,p.sendWalkMeMessage)({type:d.BOT_CLOSE}),n({type:d.FLUSH_STORE,payload:{isChatNeedDestroy:t}}),f||l.default.cancelAllRequests("Finishing dialog requires closing of chat window"));case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),n(M(e.t0)),v.default.error(e.t0);case 18:case"end":return e.stop()}},e,void 0,[[0,14]])})),function(){return e.apply(this,arguments)}}}).call(this,n(4).assign,n(18).Promise,n(35))},154:function(e,t,n){"use strict";(function(e,r,a,o){function i(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return function(){var t=e.apply(this,arguments);return new o(function(e,n){return function r(a,i){try{var s=t[a](i),u=s.value}catch(e){return void n(e)}if(!s.done)return o.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0}),t.initiateWalkMeAction=t.sendFormData=t.sendMessage=t.processConversationMessage=t.getNextConversationNode=t.getNextConversationNodeApiMode=t.setFormFieldValue=t.addSeparator=t.addIdsToLastMessage=t.addMessageToChat=t.sendMessageFail=void 0;var d,l,f=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=(d=c(r.mark(function t(n,a,o){var i,s,c,d,l,f,p,v,g,S,_,m,E,T,b;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(g=function(){if(s.form){if(n((0,A.changeInsideFormState)(o===s.form.inputs[0].nodeId)),s.form.inputs&&s.form.inputs.length>0&&o!==s.form.inputs[0].nodeId&&1===s.form.inputs.filter(function(e){return o===e.nodeId}).length)return l[p].nodesMap[s.form.inputs[s.form.inputs.length-1].nodeId].nextConversationNodeId}return o},i=a(),d=(c=i.settings).botId,f=i.dialog,v=(0,h.default)(l=c.conversationsNodesMap,[p=(s=i.conversation.picked).id,"nodes"],[]),S=(0,y.checkNextNode)({conversationNodes:v,nextConversationNodeId:g(),flatData:(0,y.getDialogFlatData)(f)}),_=S.nextId){t.next=7;break}return t.abrupt("return",null);case 7:return m=(0,h.default)(l,[p,"nodesMap",_]),t.next=10,I.default.processConversationNode({botId:d,conversationId:p,dialog:f,node:m});case 10:return T=(E=t.sent).node,(b=E.dialog)&&b.data[_]&&n((0,k.addCurrentDialogData)(u({},_,b.data[_]))),e(T,{data:a().dialog.data||{}}),t.abrupt("return",T);case 16:case"end":return t.stop()}},t,this)})),function(){return d.apply(this,arguments)}),v=t.getNextConversationNodeApiMode=(l=c(r.mark(function e(t,n,a){var o,i,s,c,d,l,p,v,g,S,y,_;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n(),i=o.settings.botId,s=o.conversation.picked.id,c=o.dialog.id,e.prev=3,e.next=6,E.default.getNextConversationNode(i,s,c,a);case 6:return e.abrupt("return",e.sent.data);case 11:if(e.prev=11,e.t0=e.catch(3),"INSUFFICIENT_DATA"!==(0,h.default)(e.t0,["response","data","reason","bbCodes"])){e.next=48;break}d=(0,h.default)(e.t0,["response","data","data","bbCodes"],[]),l=d.reduce(function(e,t){return f({},e,u({},t,""))},{}),p=!0,v=!1,g=void 0,e.prev=19,S=Object.keys(l)[Symbol.iterator]();case 21:if(p=(y=S.next()).done){e.next=29;break}return _=y.value,e.next=25,(0,C.resolveBBCodes)(_);case 25:l[_]=e.sent;case 26:p=!0,e.next=21;break;case 29:e.next=35;break;case 31:e.prev=31,e.t1=e.catch(19),v=!0,g=e.t1;case 35:e.prev=35,e.prev=36,!p&&S.return&&S.return();case 38:if(e.prev=38,!v){e.next=41;break}throw g;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.next=45,E.default.getNextConversationNode(i,s,c,a,{bbCodes:l});case 45:return e.abrupt("return",e.sent.data);case 48:throw e.t0;case 49:case"end":return e.stop()}},e,this,[[3,11],[19,31,35,43],[36,,38,42]])})),function(){return l.apply(this,arguments)}),g=i(n(307)),h=i(n(33)),S=i(n(321)),y=n(308),_=i(n(231)),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),E=i(n(78)),I=i(n(317)),T=n(67),b=n(316),w=i(n(79)),C=n(41),x=n(156),N=n(106),A=n(125),O=n(152),k=n(153),M=n(234),D=n(21),B=n(68),R=t.sendMessageFail=function(e){return{type:m.SEND_MESSAGE_FAIL,payload:{error:e}}},L=t.addMessageToChat=function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:m.ADD_MESSAGE,payload:{message:{text:e,options:f({},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{isUserMessage:!1,success:!0,isRichMessage:!1},{timestamp:Date.now()}),isForm:!!t,form:t}}}},U=t.addIdsToLastMessage=function(e,t){return{type:m.ADD_IDS_TO_LAST_MESSAGE,payload:{id:e,nodeId:t}}},P=(t.addSeparator=function(e){return{type:m.ADD_SEPARATOR,payload:{separator:e,isNewSeparator:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}},t.setFormFieldValue=function(e,t){return n=c(r.mark(function n(a){return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:a({type:m.SET_FORM_FIELD_VALUE,payload:{nodeId:e,value:t}});case 1:case"end":return n.stop()}},n,void 0)})),function(){return n.apply(this,arguments)};var n},t.getNextConversationNode=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,a=arguments[2];return t=c(r.mark(function t(o,i){var s,u,c,d,l,f,g,y,_,E,I,b,w,N,O,k,B,R;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,s=i(),c=(0,h.default)(u=s.conversation.currentNode,["settings","app"]),d=(0,h.default)(u,["settings","id"]),o((0,x.getConversationNodeSuccess)(null)),o((0,A.changeBotStatus)(!0)),l=i(),g=l.settings.botId,y=l.dialog,(f=l.conversation.picked)&&g&&y){t.next=9;break}return t.abrupt("return");case 9:if(_=y.id,E=(0,h.default)(f,D.CLIENT_SIDE_MODE,!1),I=(0,h.default)(f,D.IS_FORM,!1),t.t0=a,t.t0){t.next=17;break}return t.next=16,E||I?p(o,i,e):v(o,i,e);case 16:t.t0=t.sent;case 17:if(b=t.t0,c&&(0,T.sendWalkMeMessage)({type:m.CLEAN_APP_STARTED_FLAG,payload:{app:c,id:d}}),w=i(),!(0,C.hasBotChanged)(w,g)){t.next=22;break}return t.abrupt("return");case 22:if(w.conversation.picked&&(!w.dialog||w.dialog.id===_)){t.next=24;break}return t.abrupt("return");case 24:if(N=b.type,O=(0,C.getDelayCorrection)(b.aDelay,n),k=(0,h.default)(b,["settings","app"],""),N!==D.CONVERSATION_NODE_TYPES.action||k!==m.START_SMARTWALKTHRU&&k!==m.START_WALKTHRU||o((0,A.changeBotStatus)(!1)),O<=0){t.next=35;break}return B=(0,S.default)(w.messages),t.next=32,(0,C.delay)(O);case 32:if(R=(0,S.default)(i().messages),B===R){t.next=35;break}return t.abrupt("return");case 35:o((0,A.changeBotStatus)(!1)),o((0,x.getConversationNodeSuccess)(b)),o((0,x.processConversationNode)(b,_)),t.next=43;break;case 40:t.prev=40,t.t1=t.catch(0),o((0,M.handleError)(t.t1));case 43:case"end":return t.stop()}},t,void 0,[[0,40]])})),function(){return t.apply(this,arguments)}}),F=function(e,t){try{var n=t(),r=n.settings.liveChat,a=r.enabledGlobal,o=r.suggestionText,i=n.conversation.currentNode,u=n.analytics.retriesAnswerQuestion,c=n.suggestions.items,d=(0,h.default)(i,"liveChatEnabled",!1),l=(0,h.default)(i,"failsBeforeLiveChatTriggered",3);if(a&&d&&u>=l)c&&c.length&&c[0].id===D.LIVE_CHAT_SUGGESTION_ID||e((0,N.getSuggestionsSuccess)([{id:D.LIVE_CHAT_SUGGESTION_ID,type:D.SUGGESTION_TYPES.liveChat,displayName:o||D.DEFAULT_LABELS.liveChatSuggestionText}].concat(s(c))))}catch(e){w.default.error(e)}},G=t.processConversationMessage=function(e){var t,n=e.text,a=e.picked,o=e.dialog,i=e.currentNode,s=e.botId;return t=c(r.mark(function e(t,u){var c,d,l,f,p,v,g,S,_,b,w,R,G,W,V,j,Y,H,z,q,K,Q,X,J,Z,$,ee,te,ne,re,ae,oe,ie,se,ue;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=void 0,d=o,e.prev=2,t((0,A.changeBotStatus)(!0)),l=a.id,f=a.name,v=void 0!==(p=a.clientSideMode)&&p,S=void 0!==(g=a.isForm)&&g,_=o.id,b=i.id,w=i.name,R=i.type,G=i.dataType,W=i.suggestions,V=u(),j=V.settings.conversationsNodesMap,Y=n,"connection_salesforce"===G&&W&&("true"===n&&W.includes(!0)&&(Y=!0),"false"===n&&W.includes(!1)&&(Y=!1),W.includes(Number(n))&&(Y=Number(n))),H={botId:s,conversationId:l,dialogId:_,text:Y,nodeId:b},z=new Date,q=0,K=!1,Q=D.DEFAULT_ERROR_MESSAGE,X="extraction",J=null,e.prev=17,Z=null,!(i&&i.settings&&i.settings.queryQuestion)){e.next=28;break}return $=H.text,e.next=23,E.default.getNextConversationNode(s,l,_,b,{queryText:$});case 23:return(Z=e.sent).data.textSettings.blocks[0].inlineStyleRanges=[],Z.data.textSettings.blocks[0].text=(0,C.getSuggestionsResponseText)(Z.data),t(P(Z.data.nextConversationNodeId,z,Z.data)),e.abrupt("return");case 28:if(!v&&!S){e.next=34;break}return e.next=31,I.default.sendUserMessage(H,(0,h.default)(j,[l,"nodesMap",b],null),d);case 31:Z=e.sent,e.next=37;break;case 34:return e.next=36,E.default.sendUserMessage(H);case 36:Z=e.sent;case 37:c=ee=Z.data,q=ee.id,K=ee.success,Q=ee.errorMessage,X=ee.errorType,J=ee.nextConversationNodeId,e.next=54;break;case 46:if(e.prev=46,e.t0=e.catch(17),te=(0,h.default)(e.t0,["response","data"],{}),re=te.message,!(ne=te.reason)||"WRONG_DATA"!==ne.text||"connection_salesforce"!==G){e.next=53;break}Q=re,e.next=54;break;case 53:throw e.t0;case 54:if(ae=u(),!(0,C.hasBotChanged)(ae,s)){e.next=57;break}return e.abrupt("return");case 57:if(t(U(q,b)),t({type:m.ANALYTICS_ANSWER_QUESTION_TRY}),(0,T.sendAnalyticsEvent)(D.ANALYTICS_EVENTS.conversationsQuestionAnswered,{type:"actionBotNode",oId:b,oName:w,owId:a.id,owType:"actionBotConversation",owName:a.name,pId:_,aAppType:G,retries:ae.analytics.retriesAnswerQuestion,value:n,reason:K?3:"extraction"===X?2:1},{skipPInit:!0}),!K){e.next=75;break}if((v||S)&&(oe=I.default.getMessageData(ae,c,{conversationId:l,nodeId:b}))&&(t((0,k.addCurrentDialogData)(oe)),d=u().dialog),(v||S)&&(ie=(0,h.default)(j,[l,"nodes"],[]),se=(0,y.checkNextNode)({conversationNodes:ie,nextConversationNodeId:J,flatData:(0,y.getDialogFlatData)(d)}),J=se.nextId),!J){e.next=69;break}t(P(J,z)),e.next=73;break;case 69:return(0,T.sendAnalyticsEvent)(D.ANALYTICS_EVENTS.conversationEnded,{oId:l,oName:f,pId:_,aAppType:R,aoId:b,aoName:w,seekTime:(0,C.getConversationDuration)(ae.conversation.conversationStarted),total:ae.conversation.conversationLength,reason:1,type:"actionBotConversation",owName:ae.settings.name,pInit:{id:s,type:B.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}}),e.next=72,t((0,x.finishConversation)());case 72:t((0,O.loadBotData)(s));case 73:e.next=84;break;case 75:if((ue=(0,C.getDelayCorrection)(i.aDelay,z))<=0){e.next=80;break}return e.next=80,(0,C.delay)(ue);case 80:t((0,A.changeBotStatus)(!1)),t(L(Q,{isUserMessage:!1,success:!1})),t((0,N.restoreCurrentNodeSuggestions)()),t(F);case 84:e.next=89;break;case 86:e.prev=86,e.t1=e.catch(2),t((0,M.handleError)(e.t1));case 89:case"end":return e.stop()}},e,void 0,[[2,86],[17,46]])})),function(){return t.apply(this,arguments)}},W=function(e,t){try{var n=t(),r=n.settings.liveChat,a=n.suggestions.items;if(r.enabledGlobal&&r.enabled&&n.analytics.retriesConversationSearch>=r.failsBeforeTrigger&&!r.temporaryDisabled)a&&a.length&&a[0].id===D.LIVE_CHAT_SUGGESTION_ID||e((0,N.getSuggestionsSuccess)([{id:D.LIVE_CHAT_SUGGESTION_ID,type:D.SUGGESTION_TYPES.liveChat,displayName:r.suggestionText||D.DEFAULT_LABELS.liveChatSuggestionText}].concat(s(a))))}catch(e){w.default.error(e)}},V=function(e,t){try{var n=t(),r=n.settings,a=r.fallbackConversations,o=r.conversations,i=n.suggestions.items;if(n.analytics.retriesConversationSearch>=r.failsBeforeFallbackSuggested&&a.length){var u=i.find(function(e){return e.id===D.LIVE_CHAT_SUGGESTION_ID}),c=i.filter(function(e){var t=e.id;return![].concat(s(a),[D.LIVE_CHAT_SUGGESTION_ID]).includes(t)}),d=a.map(function(e){var t=o.find(function(t){return t.id===e});return t&&{id:e,displayName:t.displayName,type:D.SUGGESTION_TYPES.conversation}}).filter(Boolean),l=[].concat(s(u?[u]:[]),s(d),s(c));e((0,N.getSuggestionsSuccess)(l))}}catch(e){w.default.error(e)}},j=(t.sendMessage=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=c(r.mark(function t(a,o){var i,s,u,c,d,l,p,v,h,S,y,_,I,w,O,k,B,U,P,F,j,Y,H,z,q;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i={isUserMessage:!0,success:!0},n||a(L("string"==typeof e?e:String(e.displayName),i)),a((0,N.clearSuggestions)()),s=o(),d=(u=s.conversation).currentNode,p=(l=s.settings).botId,v=l.conversationId,h=l.name,S=l.noMatchedConversationErrorMessages,y=l.noConversationsOneSearchItemFoundText,_=l.severalConversationsFoundText,I=l.conversations,w=l.isWalkMeSearchEnabled,O=l.isWalkMeSearchItemsSuggestedInitially,k=s.dialog,B=s.suggestions.wmSearchItems,!((c=u.picked)&&k&&d&&p)){t.next=11;break}U=void 0,U=(0,C.isValidMessageValue)(e.extractValue)?e.extractValue:(0,C.isValidMessageValue)(e.displayName)?e.displayName:e,a(G({text:U,picked:c,dialog:k,currentNode:d,botId:p})),t.next=50;break;case 11:if(p){t.next=13;break}return t.abrupt("return");case 13:if(P=[],p!==D.DEFAULT_BOT_ID){t.next=21;break}return F=String(e).trim().toLowerCase(),t.next=18,(0,C.delay)(500);case 18:P=I.filter(function(e){return e.keywords.some(function(e){return F.includes(e.toLowerCase())})}),t.next=25;break;case 21:return t.next=23,E.default.getConversations(p,e);case 23:j=t.sent,P=v?j.data.filter(function(e){return e.id===v}):j.data;case 25:if(Y=o(),!(0,C.hasBotChanged)(Y,p)){t.next=28;break}return t.abrupt("return");case 28:return P=P.map(function(e){return f({},e,{type:D.SUGGESTION_TYPES.conversation})}),t.next=31,(0,b.filterConversationsByTags)(P);case 31:if(P=t.sent,H=w?B:[],a({type:m.ANALYTICS_CONVERSATION_SEARCH_TRY,payload:{searchTerm:e}}),!P.length&&!H.length){t.next=40;break}z=1===P.length,(0,T.sendAnalyticsEvent)(D.ANALYTICS_EVENTS.conversationsSearch,{type:"actionBotBot",oId:p,oName:h,value:e,seekTime:Y.analytics.retriesConversationSearch,total:P.length,reason:1}),z&&0===H.length?a((0,x.chooseConversation)(P[0],!0)):(a((0,N.getSuggestionsSuccess)(P)),a(L(1===H.length&&0===P.length?y||D.DEFAULT_LABELS.noConversationsOneSearchItemFoundText:_||D.DEFAULT_LABELS.severalConversationsFoundText)),a((0,A.changeFocusInput)(!0))),t.next=49;break;case 40:if(q=(0,g.default)(S),(0,T.sendAnalyticsEvent)(D.ANALYTICS_EVENTS.conversationsSearch,{type:"actionBotBot",oId:p,oName:h,value:e,seekTime:Y.analytics.retriesConversationSearch,total:P.length,reason:2}),a(L(q,{isUserMessage:!1,success:!1})),a((0,N.setInitialSuggestions)()),!w||!O){t.next=47;break}return t.next=47,a((0,N.updateWMSearchSuggestions)());case 47:a(W),a(V);case 49:a((0,A.changeBotStatus)(!1));case 50:t.next=56;break;case 52:t.prev=52,t.t0=t.catch(0),a(R(t.t0)),a((0,M.handleError)(t.t0));case 56:case"end":return t.stop()}},t,void 0,[[0,52]])})),function(){return t.apply(this,arguments)}},function(e){var t=o.resolve();return e.forEach(function(e){t=t.then(e)}),t});t.sendFormData=function(e,t){return n=c(r.mark(function n(a,o){var i,s,u,c,d,l,f,p;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a({type:m.SUBMIT_FORM_DATA,payload:{values:e}}),i=o(),u=(s=i.dialog).botId,c=s.id,d=s.conversationId,f=(l=i.conversation.picked).nodes,p={},l.form.inputs.map(function(e){return f.find(function(t){return t.id===e.nodeId}).validations}).forEach(function(t){t&&t.forEach(function(t){p[t.conversationNodeQuestionId]||(_.default.apply(t.condition.logic,e)||(p[t.conversationNodeQuestionId]=t.error))})}),a({type:m.SET_FORM_ERRORS,payload:{invalidFields:p}}),Object.keys(p).length<=0){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,j(Object.keys(e).map(function(t){return e[t]&&function(){return E.default.sendUserMessage({botId:u,conversationId:d,dialogId:c,text:e[t],nodeId:t})}}).filter(function(e){return!!e}));case 9:return n.next=11,(0,x.processConversationNextNodeOfId)(t)(a,o);case 11:case"end":return n.stop()}},n,void 0)})),function(){return n.apply(this,arguments)};var n},t.initiateWalkMeAction=function(e,t){return n=c(r.mark(function n(a,o){var i,s;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=o(),s={type:m.WALK_ME_ACTION,payload:{settings:{id:e,app:t},answers:{},chatHistory:[],options:{conversationId:null,botId:i.settings.botId,dialogId:null}}},(0,T.sendWalkMeMessage)({type:m.BOT_HIDE}),(0,T.sendWalkMeMessage)(s);case 4:case"end":return n.stop()}},n,void 0)})),function(){return n.apply(this,arguments)};var n}}).call(this,n(4).assign,n(35),n(38).from,n(18).Promise)},156:function(e,t,n){"use strict";(function(e,r,a,o,i){function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}var d;Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstConversationNode=t.processConversationNextNodeOfId=t.processConversationNode=t.openLiveChat=t.finishConversation=t.getConversationNodeSuccess=t.chooseConversation=t.setCurrentNode=void 0;var l,f,p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),g=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h=s(n(33)),S=s(n(78)),y=n(67),_=s(n(79)),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),E=n(154),I=n(234),T=n(153),b=n(152),w=n(125),C=n(106),x=n(41),N=n(21),A=n(68),O=n(388),k=function(e){return e.reduce(function(e,t){var n=t.text,r=t.options;if((0,h.default)(r,"isSeparator"))return e;var o=n;return(0,h.default)(r,"isRichMessage")&&(o=(0,x.stripHTMLTags)(n)),[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}(e),[{text:o,options:{isUserMessage:r.isUserMessage,timestamp:r.timestamp}}])},[])},M=(t.setCurrentNode=function(e){return function(t){t({type:m.SET_CURRENT_NODE,payload:{nodeId:e}})}},t.chooseConversation=function(e){var t=1>=arguments.length||void 0===arguments[1]||arguments[1];return function(n,r){var a=r();n({type:m.CHOOSE_CONVERSATION_SUCCESS,payload:{conversation:e,byKeyword:a.analytics.searchTerm}}),t&&n((0,T.createDialog)())}}),D=t.getConversationNodeSuccess=function(e){return{type:m.GET_CONVERSATION_NODE_SUCCESS,payload:{node:e,incrementCounter:Boolean(e)}}},B=t.finishConversation=function(){var e,t=0>=arguments.length||void 0===arguments[0]||arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=2>=arguments.length||void 0===arguments[2]||arguments[2];return e=c(o.mark(function e(a,i){var s,u,c,d;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=i(),c=(u=s.settings).doneText,d=u.separatorCompletedText,a((0,w.changeBotStatus)(!1)),a((0,w.changeInsideFormState)(!1)),t&&(a((0,E.addSeparator)(d||N.DEFAULT_LABELS.separatorCompletedText)),a((0,E.addMessageToChat)(c||N.DEFAULT_LABELS.doneText))),e.next=6,a((0,T.finishCurrentDialog)(n));case 6:a(r?(0,C.setInitialSuggestions)():(0,C.clearSuggestions)()),a({type:m.FINISH_CONVERSATION});case 8:case"end":return e.stop()}},e,void 0)})),function(){return e.apply(this,arguments)}},R=function(e,t){var n=e.conversation,r=n.picked,a=n.conversationLength,o=e.settings,i=o.botId,s=o.name;return{oId:r.id,oName:r.name,pId:e.dialog.id,aAppType:t.type,aoId:t.id,aoName:t.name,seekTime:(0,x.getConversationDuration)(n.conversationStarted),total:a,type:"actionBotConversation",owName:s,pInit:{id:i,type:A.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}}},L=t.openLiveChat=function(){return e=c(o.mark(function e(t,n){var r,a,i,s,u,c,d,l,f,p,v;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n(),i=(a=r.settings).botId,s=a.liveChat.enabledGlobal,u=r.conversation.picked,c=r.dialog,d=r.messages,l=r.suggestions,e.prev=1,s){e.next=4;break}throw new Error("LIVE_CHAT isn't enabled globally but tried to initiate session");case 4:return f=(0,h.default)(u,"id"),p=(0,h.default)(c,"id"),v={app:m.LIVE_CHAT},e.next=9,(0,y.sendWalkMeMessage)({type:m.WALK_ME_ACTION,payload:{settings:v,options:{conversationId:f,botId:i,dialogId:p},chatHistory:k(d)}});case 9:e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(1),t({type:m.DISABLE_LIVE_CHAT}),t((0,C.getSuggestionsSuccess)(l.items.filter(function(e){return e.id!==N.LIVE_CHAT_SUGGESTION_ID}))),new Error("Action type LIVE_CHAT failed.");case 16:case"end":return e.stop()}},e,void 0,[[1,11]])})),function(){return e.apply(this,arguments)};var e},U=function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,i=e.nextConversationNodeId,s=e.textSettings,u=e.data,c=e.text,d=r(),l=d.settings.botId,f=s?(0,x.convertToPureText)(s,u,d.settings):c,n((0,w.changeBotStatus)(!0)),t.next=7,(0,x.resolveBBCodes)(f);case 7:if(n((0,E.addMessageToChat)(t.sent,{id:a,isUserMessage:!1,success:!0,isRichMessage:!0})),i){t.next=16;break}return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},R(d,e),{reason:1})),t.next=13,n(B());case 13:n((0,b.loadBotData)(l,!1,!1,!1)),t.next=17;break;case 16:n((0,E.getNextConversationNode)(i));case 17:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t},P=function(e){return t=c(o.mark(function t(n,r){var a;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=r(),n((0,E.addMessageToChat)("",{id:e.id,isUserMessage:!1,success:!0,isRichMessage:!0},a.conversation.picked.form));case 4:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t},F=function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,p;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r(),i=e.id,u=e.text,c=e.dataType,d=e.suggestions,l=(s=e.textSettings)?(0,x.convertToPureText)(s,e.data,a.settings):u,t.next=5,(0,x.resolveBBCodes)(l);case 5:f=t.sent,n(e&&e.isInvisible&&e.autoDataSource?(0,E.sendMessage)(a.settings&&a.settings.walkmeEndUserId,!0):(0,E.addMessageToChat)(f,{id:i,isUserMessage:!1,success:!0,isRichMessage:!0})),p=(0,C.getNextSuggestions)(e,d),n((0,w.changeBotStatus)(!1)),n((0,C.getSuggestionsSuccess)(p)),c===N.SALESFORCE_QUESTION_TYPE&&d.length===N.MIN_SUGGESTIONS_CHUNK_SIZE&&n((0,C.getRestSuggestions)(i)),n((0,w.changeFocusInput)(!0));case 12:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t},G=function(t,n){var r=Object.keys(t).reduce(function(e,r){var a=t[r],o=n[r];return a&&o?g({},e,u({},a,o)):e},{});return e({},r)},W=function(e){var t=e.dataMapping,n={},r=e.dialog.data;return e.picked.form.inputs.forEach(function(e){n[e.nodeId]={type:"text",settings:{},value:r[e.nodeId],nodeId:e.nodeId,name:e.name}}),G(t,n)},V=(l=c(o.mark(function e(t){var n,r,a,s=t.botId,c=t.conversationId,d=t.dialogId,l=t.clientSideMode,f=t.dialog,h=t.app,y=t.dataMapping;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},!O.ACTIONS_REQUIRE_DATA_SAVE.includes(h)){e.next=13;break}if(r={},!l){e.next=7;break}r=f.data,e.next=11;break;case 7:return e.next=9,S.default.getDialog(s,c,d);case 9:r=e.sent.data.data;case 11:a=i(r).reduce(function(e,t){var n=v(t,2),r=n[0],a=n[1];return a&&a.type===N.MENTION_DATA_TYPES.variable?"object"===p(a.value)?g({},e,i(a.value).reduce(function(e,t){var n=v(t,2);return g({},e,u({},n[0],{value:n[1],nodeId:Number(r)}))},{})):e:g({},e,u({},r,g({},a,{nodeId:Number(r)})))},{}),n=G(y,a);case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}},e,void 0)})),function(){return l.apply(this,arguments)}),j=(f=c(o.mark(function e(t){var n=t.botId,r=t.conversationId,a=t.dialogId,i=t.clientSideMode,s=t.picked,u=t.dialog,c=t.app,d=t.dataMapping;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s&&s.form&&s.form.inputs)){e.next=2;break}return e.abrupt("return",W({picked:s,dialog:u,dataMapping:d}));case 2:return e.abrupt("return",V({botId:n,conversationId:r,dialogId:a,clientSideMode:i,dialog:u,app:c,dataMapping:d}));case 3:case"end":return e.stop()}},e,void 0)})),function(){return f.apply(this,arguments)}),Y=(u(d={},m.WEBHOOK,function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,p,v,h,S,_,m;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.id,i=e.name,u=e.type,c=e.nextConversationNodeId,d=e.success,l=e.isConversationEnd,f=(s=e.settings).mandatory,p=s.errorMessage,v=r(),(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:a,oName:i,owId:(h=v.conversation.picked).id,owType:"actionBotConversation",owName:h.name,pId:v.dialog.id,aType:"webhooksDestination",aAppType:u,aoId:s.id,reason:(S=!f||f&&d)?1:2},{skipPInit:!0}),_=g({},R(v,e),{aType:"webhooksDestination",oIsWithAction:!0,wId:s.id}),!S){t.next=22;break}if(!l){t.next=13;break}return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},_,{reason:1})),t.abrupt("return",n(B(!0)));case 13:if(l||!c){t.next=17;break}n((0,E.getNextConversationNode)(c)),t.next=20;break;case 17:return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},_,{reason:4})),n((0,E.addMessageToChat)(N.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.abrupt("return",n(B()));case 20:t.next=30;break;case 22:if((0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},_,{reason:4})),m=N.DEFAULT_ERROR_MESSAGE,!p){t.next=28;break}return t.next=27,(0,x.resolveBBCodes)(p);case 27:m=t.sent;case 28:return n((0,E.addMessageToChat)(m,{isUserMessage:!1,success:!1})),t.abrupt("return",n(B()));case 30:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t}),u(d,m.LIVE_CHAT,function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,p,v;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.id,i=e.name,s=e.settings,u=e.type,c=e.nextConversationNodeId,d=e.isConversationEnd,l=r(),f=l.settings.additionalSettings,(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:a,oName:i,owId:(p=l.conversation.picked).id,owType:"actionBotConversation",owName:p.name,pId:l.dialog.id,aType:"liveChat",aAppType:u},{skipPInit:!0}),v=g({},R(l,e),{aType:"liveChat",oIsWithAction:!0,wId:s.id}),t.prev=5,t.next=8,n(L());case 8:if(!d){t.next=13;break}return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},v,{reason:1})),t.abrupt("return",n(B(!0,!f.playMode)));case 13:if(d||!c){t.next=17;break}n((0,E.getNextConversationNode)(c)),t.next=20;break;case 17:return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},v,{reason:4})),n((0,E.addMessageToChat)(N.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.abrupt("return",n(B()));case 20:t.next=29;break;case 22:return t.prev=22,t.t0=t.catch(5),_.default.error(t.t0,!0),n((0,E.addMessageToChat)(N.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.next=28,n(B());case 28:(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},v,{reason:4}));case 29:case"end":return t.stop()}},t,void 0,[[5,22]])})),function(){return t.apply(this,arguments)};var t}),u(d,m.CONVERSATION,function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,p,v,h;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.type,s=e.id,u=(a=e.settings).id,c=r(),d=c.conversation.picked,l=c.dialog,f="actionBotConversation",p=c.settings.allConversations.find(function(e){return e.id===u}),(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:s,oName:name,owId:d.id,owType:"actionBotConversation",owName:d.name,pId:l.id,aType:f,aAppType:i,aoId:a.id},{skipPInit:!0}),v=g({},R(c,e),{aType:f,oIsWithAction:!0,wId:a.id}),!p){t.next=13;break}return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},v,{reason:1})),t.next=12,n(B(!1,!1,!1));case 12:return t.abrupt("return",n(M(p)));case 13:return(h=c.settings.additionalSettings).playMode&&"conversation"===h.previewEntityType&&(0,y.sendWalkMeMessage)({type:m.WALK_ME_ACTION,payload:{settings:a}}),_.default.error(new Error("Bot tried to launch Conversation which is not present in its conversation list."),!0),(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},v,{reason:4})),n((0,E.addMessageToChat)(N.DEFAULT_ERROR_MESSAGE,{isUserMessage:!1,success:!1})),t.abrupt("return",n(B()));case 19:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t}),d),H=function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f,p,v,S,I,T,C,A,O,M,D,L,U,P,F,G,W,V,H,z,q,K;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a=e.id,i=e.name,s=e.type,u=e.actionType,c=e.settings,d=e.dataMapping,l=e.isConversationEnd,f=e.nextConversationNodeId,p=r(),S=(v=p.settings).botId,I=v.additionalSettings,T=v.globalConfig,C=v.jwt,A=p.conversation.picked,O=p.dialog,M=p.messages,D=(0,h.default)(c,"app",""),L=(0,h.default)(A,N.CLIENT_SIDE_MODE,!1),U=[m.START_WALKTHRU,m.START_SMARTWALKTHRU,m.SMARTWALKTHRU].includes(D),P=U&&!e.hasOwnProperty("isConversationEnd")&&null===f,F=!I.playMode&&![m.WEBHOOK,m.CONVERSATION,m.LIVE_CHAT].includes(D)&&(0,h.default)(T,"closeOnAction",!0)&&(l||P),G=void 0,!c||c.app!==m.WEB_INTEGRATION){t.next=15;break}return t.next=14,(0,x.extractBBCodesFromText)(c.destinationUrl);case 14:G=t.sent;case 15:if(F&&(0,y.sendWalkMeMessage)({type:m.BOT_HIDE}),S){t.next=18;break}return t.abrupt("return");case 18:if("WalkMe"===u){t.next=20;break}throw new Error("Unknown action type: "+u);case 20:return W=A.id,V=O.id,H=k(M),t.next=25,j({botId:S,conversationId:W,dialogId:V,clientSideMode:L,picked:A,dialog:O,app:D,dataMapping:d});case 25:if(z=t.sent,!Y[D]){t.next=29;break}return n((0,w.changeBotStatus)(!0)),t.abrupt("return",n(Y[D](e)));case 29:if(!l&&!P){t.next=35;break}return t.next=32,n(B(!0,F));case 32:n((0,b.loadBotData)(S,!1,!1,!1)),(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationActionTriggered,{type:"actionBotNode",oId:a,oName:i,owId:A.id,owType:"actionBotConversation",owName:A.name,pId:O.id,aType:"bizFlow",aAppType:s,aoId:c.id},{skipPInit:!0}),(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationEnded,g({},R(p,e),{aType:"bizFlow",pId:V,oIsWithAction:!0,wId:c.id,reason:1}));case 35:if(q=(0,h.default)(c,"waitForActionEnds",!1),K={type:m.WALK_ME_ACTION,payload:{settings:c,answers:z,chatHistory:H,options:{conversationId:W,botId:S,dialogId:V,nodeId:a,jwt:C}}},G&&(K.payload.options.bbCodes=JSON.stringify(G)),!q||I.playMode){t.next=45;break}return n((0,w.changeBotStatus)(!0)),t.next=42,(0,y.sendWalkMeMessage)(K);case 42:n((0,w.changeBotStatus)(!1)),t.next=46;break;case 45:(0,y.sendWalkMeMessage)(K);case 46:f&&n((0,E.getNextConversationNode)(f)),t.next=52;break;case 49:t.prev=49,t.t0=t.catch(0),_.default.error(t.t0);case 52:case"end":return t.stop()}},t,void 0,[[0,49]])})),function(){return t.apply(this,arguments)};var t},z=t.processConversationNode=function(e,t){return n=c(o.mark(function n(r,a){var i,s,c,d,l,f,p,v,h,S;return o.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(s=e.id,c=e.type,d=e.name,l=e.settings,f=a(),p=f.conversation.picked,(!(v=f.dialog)||v.id===t)&&p&&v){n.next=5;break}return n.abrupt("return");case 5:return(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationsNodeServed,g({type:"actionBotNode",oId:s,oName:d,owId:p.id,owType:"actionBotConversation",owName:p.name,pId:v.id,aAppType:c},c===N.CONVERSATION_NODE_TYPES.action&&{aoId:l.id}),{skipPInit:!0}),h=p.form&&p.form.entryNodeId===s?N.CONVERSATION_NODE_TYPES.form:c,u(i={},N.CONVERSATION_NODE_TYPES.message,U),u(i,N.CONVERSATION_NODE_TYPES.question,F),u(i,N.CONVERSATION_NODE_TYPES.action,H),u(i,N.CONVERSATION_NODE_TYPES.form,P),n.abrupt("return",(S=i)[h]&&r(S[h](e)));case 9:case"end":return n.stop()}},n,void 0)})),function(){return n.apply(this,arguments)};var n};t.processConversationNextNodeOfId=function(e){return t=c(o.mark(function t(n,r){var a,i,s,u,c,d,l,f;return o.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r(),u=(i=a.conversation.picked)[N.CLIENT_SIDE_MODE],c=a.dialog.id,d=(s=i.nodes).find(function(t){return t.id===e}),l=d.nextConversationNodeId,f=s.find(function(e){return e.id===l}),u){t.next=7;break}return t.next=7,(0,E.getNextConversationNodeApiMode)(n,r,l);case 7:return t.next=9,z(f,c)(n,r);case 9:case"end":return t.stop()}},t,void 0)})),function(){return t.apply(this,arguments)};var t},t.getFirstConversationNode=function(){return e=c(o.mark(function e(t,n){var r,a,i,s,c,d,l,f,p,v,_,m,E,T,b,C,O,k,M,B,R,L,U,P,F;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t((0,w.changeBotStatus)(!0)),r=n(),s=(i=r.settings).botId,c=i.name,d=i.conversationsNodesMap,l=r.dialog,p=(a=r.conversation).byKeyword,(f=a.picked)&&s&&l){e.next=6;break}return e.abrupt("return");case 6:if(v=l.id,_=f.id,m=new Date,E=(0,h.default)(f,N.CLIENT_SIDE_MODE,!1),T=(0,h.default)(f,N.IS_FORM,!1),b=void 0,!E&&!T){e.next=17;break}C=(0,h.default)(d,[_,"entryPointId"]),b=(0,h.default)(d,[_,"nodesMap",C]),e.next=65;break;case 17:return e.prev=17,e.next=20,S.default.getFirstConversationNode(s,_,v);case 20:b=e.sent.data,e.next=65;break;case 25:if(e.prev=25,e.t0=e.catch(17),"INSUFFICIENT_DATA"!==(0,h.default)(e.t0,["response","data","reason","bbCodes"])){e.next=64;break}O=(0,h.default)(e.t0,["response","data","data","bbCodes"],[]),k=O.reduce(function(e,t){return g({},e,u({},t,""))},{}),M=!0,B=!1,R=void 0,e.prev=33,L=Object.keys(k)[Symbol.iterator]();case 35:if(M=(U=L.next()).done){e.next=43;break}return P=U.value,e.next=39,(0,x.resolveBBCodes)(P);case 39:k[P]=e.sent;case 40:M=!0,e.next=35;break;case 43:e.next=49;break;case 45:e.prev=45,e.t1=e.catch(33),B=!0,R=e.t1;case 49:e.prev=49,e.prev=50,!M&&L.return&&L.return();case 52:if(e.prev=52,!B){e.next=55;break}throw R;case 55:return e.finish(52);case 56:return e.finish(49);case 57:return e.next=59,S.default.getFirstConversationNode(s,_,v,{bbCodes:k});case 59:b=e.sent.data,e.next=65;break;case 64:throw e.t0;case 65:if(!(0,x.hasBotChanged)(n(),s)){e.next=67;break}return e.abrupt("return");case 67:if(!b){e.next=79;break}if((F=(0,x.getDelayCorrection)(b.aDelay,m))<=0){e.next=73;break}return e.next=73,(0,x.delay)(F);case 73:if(n().dialog===l){e.next=76;break}return e.abrupt("return");case 76:(0,y.sendAnalyticsEvent)(N.ANALYTICS_EVENTS.conversationStarted,g({type:"actionBotConversation",oId:f.id,oName:f.name,owName:c,pId:v,pInit:{id:s,type:A.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}},p?{value:p}:null)),t(D(b)),t(z(b,v));case 79:e.next=84;break;case 81:e.prev=81,e.t2=e.catch(0),t((0,I.handleError)(e.t2));case 84:case"end":return e.stop()}},e,void 0,[[0,81],[17,25],[33,45,49,57],[50,,52,56]])})),function(){return e.apply(this,arguments)};var e}}).call(this,n(4).assign,n(18).Promise,n(38).from,n(35),n(4).entries)},234:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleError=void 0;var a=r(n(33)),o=n(154),i=n(125),s=n(106),u=n(153),c=n(67),d=r(n(79)),l=n(41),f=n(21),p=n(68),v=r(n(78));t.handleError=function(e){return function(t,n){if(!v.default.isCanceled(e)){t((0,i.changeBotStatus)(!1));var r=n().settings,g=r.conversationUnpublishedText,h=r.conversationUpdatedText,S=(0,a.default)(e,["response","data","reason"],""),y=f.DEFAULT_ERROR_MESSAGE;S?("WRONG_DATA"===S.version&&(y=h||f.DEFAULT_LABELS.conversationUpdatedText),"NOT_PUBLISHED"!==S.published&&"WRONG_ID"!==S.conversationId||(y=g||f.DEFAULT_LABELS.conversationUnpublishedText),"NOT_ASSIGNED"===S.conversationId&&(y=f.DEFAULT_ERROR_MESSAGE)):d.default.error(e),t((0,u.finishCurrentDialog)()),t((0,s.clearSuggestions)()),t((0,o.addMessageToChat)(y));var _=n(),m=_.settings,E=m.botId,I=m.name,T=_.conversation,b=T.picked,w=T.currentNode,C=T.conversationLength,x=_.dialog;x&&b&&w&&(0,c.sendAnalyticsEvent)(f.ANALYTICS_EVENTS.conversationEnded,{oId:b.id,oName:b.name,pId:x.id,aAppType:w.type,aoId:w.id,aoName:w.name,seekTime:(0,l.getConversationDuration)(T.conversationStarted),total:C,reason:3,type:"actionBotConversation",owName:I,pInit:{id:E,type:p.WM_DEPLOYABLE_IDS.actionBot,appType:"actionBotBot"}})}}}},236:function(e,t,n){"use strict";(function(e,n,r){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();window._walkmeActionBotInternal={walkmeOpenUrl:function(e){return location.href(e)},evaluateTagsById:function(){return e.resolve(!0)}};var o,i,s=function(){return window.parent._walkmeActionBotInternal?window.parent._walkmeActionBotInternal:window._walkmeActionBotInternal},u=(o=r.mark(function e(t){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!t||0>=t.length||s().evaluateTagsById(t));case 1:case"end":return e.stop()}},e,void 0)}),i=function(){var t=o.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})},function(){return i.apply(this,arguments)});t.default={init:function(e){var t=!0,r=!1,o=void 0;try{for(var i,s=n(e)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var u=a(i.value,2),c=u[1];c&&(window._walkmeActionBotInternal[u[0]]=c)}}catch(e){r=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(r)throw o}}},walkmeOpenUrl:function(e){return e&&s().walkmeOpenUrl(e)},evaluateTagsById:u}}).call(this,n(18).Promise,n(4).entries,n(35))},316:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.filterConversationsByTags=void 0;t.filterConversationsByTags=(a=e.mark(function t(n){var a;return e.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.all(n.map(function(e){return u.default.evaluateTagsById(e.tagIds)}));case 2:return a=e.sent,e.abrupt("return",n.filter(function(e,t){return a[t]}));case 4:case"end":return e.stop()}},t,this)}),o=function(){var e=a.apply(this,arguments);return new r(function(t,n){return function a(o,i){try{var s=e[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});t(u)}("next")})},function(){return o.apply(this,arguments)});var a,o,i,s=n(236),u=(i=s)&&i.__esModule?i:{default:i}}).call(this,n(35),n(18).Promise)},317:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=o(n(33)),d=n(308),l=o(n(422)),f=o(n(231)),p=o(n(434)),v=o(n(435)),g=o(n(436)),h=o(n(78)),S=n(24),y=n(21);f.default.add_operation("Date",Date);var _,m,E={date:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).utcOffset;if(!(e instanceof Date)&&Number.isNaN(Date.parse(e)))return e;if((0,p.default)(t))throw new Error("utcOffset is mandatory");if("number"!=typeof t)throw new Error("utcOffset should be a number");return(0,g.default)(new Date(e),t).toString()}},I=function(e,t){return(0,(0,l.default)()(t.dataType).execute)(e,t)},T=(_=i(a.mark(function t(n,r,o){var i,c,l,g,S,_,m,T,b,w,C,x,N;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r?JSON.parse(JSON.stringify(r)):r,c=i.nextConversationNodeId,S=n.botId,_=n.conversationId,m={success:!0,text:l=n.text,id:g=n.nodeId,dialogId:o.id,errorMessage:null,dataType:i.dataType,createdAt:(new Date).toISOString()},t.prev=4,T=(0,d.getDialogFlatData)(o),!(i=(0,d.replaceSuggestionsKeys)(i,T)).isSuggestionsOnly||y.CONNECTION_TYPES.hasOwnProperty(i.dataType)||i.suggestions.includes(l)){t.next=9;break}throw new Error("An answer should be only from suggestions",{errorData:{code:"BAD_REQUEST",message:"An answer should be only from suggestions",reason:{text:"WRONG_DATA"}}});case 9:if(b=void 0,!y.CONNECTION_TYPES.hasOwnProperty(i.dataType)){t.next=19;break}return t.next=13,h.default.postConnectionMessage({botId:S,conversationId:_,nodeId:g,text:l,dialog:o});case 13:e(m,{data:b=t.sent.data.data}),t.next=23;break;case 19:b=I(l,i),w={utcOffset:(new Date).getTimezoneOffset()},E.hasOwnProperty(i.dataType)&&(b=E[i.dataType](b,w)),e(m,{data:b});case 23:C=(0,v.default)(o.data,s({},i.id,{value:b,settings:i.settings,type:i.dataType})),T=(0,d.getDialogFlatData)(u({},o,{data:C})),(0,p.default)(b)?(c=null,m.success=!1,m.errorMessage=i.errorMessage,m.errorType="extraction"):(N=(void 0===(x=i.validations)?[]:x).find(function(e){return!f.default.apply(e.condition.logic,T)}))&&(c=null,m.success=!1,m.errorMessage=N.error,m.errorType="validation"),m.success&&e(m,{nextConversationNodeId:c,success:!0,id:g}),t.next=32;break;case 29:return t.prev=29,t.t0=t.catch(4),t.abrupt("return",{data:e(m,{nextConversationNodeId:c,success:!1,id:g,errorMessage:t.t0.message})});case 32:return t.abrupt("return",{data:m});case 33:case"end":return t.stop()}},t,void 0,[[4,29]])})),function(){return _.apply(this,arguments)}),b=(m=i(a.mark(function t(n){var r,o,i,s,u,c,d,l,f;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.botId,i=n.conversationId,s=n.dialog,u={node:r=n.node,dialog:null},r){t.next=4;break}return t.abrupt("return",u);case 4:if(d=r.settings,l=r.id,(c=r.type)!==y.CONVERSATION_NODE_TYPES.question||!y.CONNECTION_TYPES.hasOwnProperty(r.dataType)){t.next=16;break}return t.prev=6,t.next=9,h.default.postNode({botId:o,conversationId:i,nodeId:l,dialog:s});case 9:e(u,{node:t.sent.data.node}),t.next=16;break;case 14:t.prev=14,t.t0=t.catch(6);case 16:if(c!==y.CONVERSATION_NODE_TYPES.action||d.app!==S.WEBHOOK){t.next=27;break}return t.prev=17,t.next=20,h.default.postNode({botId:o,conversationId:i,nodeId:l,dialog:s});case 20:e(u,{node:(f=t.sent.data).node,dialog:f.dialog}),t.next=27;break;case 25:t.prev=25,t.t1=t.catch(17);case 27:return t.abrupt("return",u);case 28:case"end":return t.stop()}},t,void 0,[[6,14],[17,25]])})),function(){return m.apply(this,arguments)});t.default={createLocalDialog:function(e){var t=e.botId,n=e.conversationId,r=e.envId;return{id:(new Date).getTime(),dataKeysSequence:[],data:{},botId:t,conversationId:n,envId:r}},getMessageData:function(e,t,n){var r=n.nodeId,a=(0,c.default)(e,["settings","conversationsNodesMap",n.conversationId,"nodesMap",r]);return a?s({},r,{type:a.dataType,value:t.data,settings:a.settings||{}}):null},sendUserMessage:T,processConversationNode:b}}).call(this,n(4).assign,n(18).Promise,n(35))},322:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeRequestingSalesforce=void 0;var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24));t.changeRequestingSalesforce=function(e){return{type:r.REQUESTING_SALESFORCE,payload:{salesforceState:e,oauthUrl:arguments.length>1&&void 0!==arguments[1]?arguments[1]:""}}}},41:function(e,t,n){"use strict";(function(e,r,a,o,i){function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function u(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}function d(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,n=Math.abs(t.getTime()-e.getTime());return Math.floor(n/864e5)}function p(e){if(e>3&&21>e)return e+"th";switch(e%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd";default:return e+"th"}}function v(e,t){var n=f(e,new Date);return 0===n?t.today:1===n?t.yesterday:e.toLocaleString("en-us",{month:"short"})+" "+p(e.getDate())}function g(e){function t(e,t){var r=(0,b.default)(e,["data","mention","id"],0),a=(0,b.default)(n,r,null);if(!a)return null;var o=(0,b.default)(a,["settings","format"],O.DATE_FORMATS.littleEndian),i=(0,A.default)(a,""+O.DATE_FORMATS[o]),s="boolean"==typeof i?String(i):i;return D(s)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?"<"+t+">"+e+"</"+t+">":e}(s,function(e){var t=/^<(\w+)>.*<\/(\w+)>/.exec(e);if(t){var n=_(t,3),r=n[1],a=n[2];return r&&a&&r===a?r:""}return""}(t)):t}var n=o((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})||{}).reduce(function(e,t){var n=_(t,2),r=n[0],a=n[1];return O.QUESTION_DATA_TYPES.hasOwnProperty(a.type)?y({},e,l({},r,a)):a.type===O.MENTION_DATA_TYPES.variable&&"object"===S(a.value)?y({},e,o(a.value).reduce(function(e,t){var n=_(t,2);return y({},e,l({},n[0],{type:O.MENTION_DATA_TYPES.variable,value:n[1]}))},{})):"identifier"!==a.type||"wm-euid"!==r&&"wm-sfid"!==r?e:y({},e,l({},r,a))},{}),r=y({},e,{blocks:e.blocks.map(function(e){return""===e.text&&(e.text="\n"),y({},e,{text:(0,w.default)(e.text)})})});return(0,C.default)(r,void 0,void 0,function(e,n){switch(e.type){case"LINK":return'<a href="'+e.data.url+'" target="_blank" rel="noopener noreferrer">'+n+"</a>";case"mention":return D(t(e,n))?String(t(e,n)):Object.create({toString:function(){return""},valueOf:function(){return""}});default:return n}})}function h(e,t){return e>1?t+"s":t}Object.defineProperty(t,"__esModule",{value:!0}),t.nodeHasSuggestions=t.suggestionsSorter=t.getInitialWMSearchResult=t.extractBBCodesFromText=t.resolveBBCodes=t.getWMSearchResult=t.stripHTMLTags=t.noop=t.toHyphenCase=t.isValidMessageValue=t.safeDomElementRemove=void 0;var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.createReducer=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments[1],a=t[r.type];return a?a(n,r.payload):n}},t.rearrangeStyles=function(){var e=document.getElementById(O.STYLE_TAG_ID);e&&(M(e),document.head&&document.head.append(e))},t.applyStyles=function(e){var t,n;(function(){var e=document.getElementById(O.LINK_TAG_ID);e&&M(e);var t=document.getElementById(O.STYLE_TAG_ID);t&&(t.textContent="")})(),e?x.test(e)?(t=e,(n=document.createElement("link")).id=O.LINK_TAG_ID,n.onload=function(){return(0,k.sendWalkMeMessage)({type:N.BOT_SHOW})},n.type="text/css",n.rel="stylesheet",n.href=t,document.head&&document.head.append(n)):function(e){var t=document.getElementById(O.STYLE_TAG_ID);t||((t=document.createElement("style")).id=O.STYLE_TAG_ID,document.head&&document.head.append(t));var n=document.createTextNode(e);t.append(n),(0,k.sendWalkMeMessage)({type:N.BOT_SHOW})}(e):(0,k.sendWalkMeMessage)({type:N.BOT_SHOW})},t.splitStringByValue=function(e,t){var n=e.toLowerCase().indexOf(t.toLowerCase());if(!t||-1===n)return[e];var r=n+t.length;return[e.slice(0,n),e.slice(n,r),e.slice(r)]},t.delay=function(e){return new r(function(t){return setTimeout(t,e)})},t.getDelayCorrection=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return e-((arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date).getTime()-t.getTime())},t.getDaysDiff=f,t.getOrdinal=p,t.getDateLabelFromToday=v,t.convertToPureText=g,t.mapRestoredDialogToMessages=function(e,t,n){var r=void 0,a=e.reduce(function(e,t){var r=t.textSettings?g(t.textSettings,n):t.text;return e.push(y({},t,{text:r})),e},[]).reduce(function(n,a,o){if(a.type===O.CONVERSATION_NODE_TYPES.action)return n;if(a.isInvisible)return n;var i=0===o?void 0:e[o-1],s=i&&i.id,u=new Date(a.createdAt);return i&&i.isInvisible?n:(r&&!f(r,u)||(n.push({text:v(u,t),isSeparator:!0}),r=u),Object.keys(a).includes("success")&&!a.success&&s?[].concat(d(n),[y({},a,{nodeId:s}),{text:a.errorMessage,type:O.CONVERSATION_NODE_TYPES.message,success:!1}]):!a.type&&s?[].concat(d(n),[y({},a,{nodeId:s})]):(n.push(a),n))},[]).map(function(e){var t=e.id,n=e.nodeId,r=e.text,a=e.success,o=e.isSeparator,i=e.createdAt,s=e.isForm,u=e.form,c=!e.type,d=Boolean(e.textSettings),l=i&&new Date(i).getTime();return c&&t&&n?{text:r,options:{isUserMessage:c,success:a,id:t,nodeId:n,timestamp:l}}:o?{text:r,options:{isSeparator:o}}:{text:r,options:{isRichMessage:d,isUserMessage:c,success:a,timestamp:l},isForm:s,form:u}});return a.some(function(e){return e.options.isSeparator&&e.text===t.today})||a.push({text:t.today,options:{isSeparator:!0}}),a},t.getConversationDuration=function(e){return Math.round((Date.now()-e)/1e3)},t.hasBotChanged=function(e,t){return e.settings.botId!==t},t.mapSuggestions=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O.SUGGESTION_TYPES.text;return e.map(function(e,n){return D(e.displayValue)&&D(e.extractValue)?{id:t===O.SUGGESTION_TYPES.staticSuggestion?""+O.SUGGESTIONS_STATIC_PREFIX+B(String(e.displayValue))+"-"+n:B(String(e.displayValue))+"-"+n,displayName:e.displayValue,type:O.SUGGESTION_TYPES.text,extractValue:e.extractValue}:"object"!==(void 0===e?"undefined":S(e))?{id:t===O.SUGGESTION_TYPES.staticSuggestion?""+O.SUGGESTIONS_STATIC_PREFIX+B(String(e))+"-"+n:B(String(e))+"-"+n,displayName:e,type:e.type||O.SUGGESTION_TYPES.text}:{}}).filter(function(e){return D(e.displayName)})},t.getSuggestionByName=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(function(t){return String(t.displayName).toLowerCase().trim()===e.toLowerCase().trim()})},t.getPreviousSibling=function(e,t){var n=e.previousElementSibling;if(!t)return n;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}},t.pluralizeString=h,t.getSuggestionsResponseText=function(e){var t=e.suggestions.length,n="I found "+(1===t?"the":t)+" "+e.settings.pullValuesFrom+" "+h(t,"result")+". Please select from my Suggestions below.",r="No "+e.settings.pullValuesFrom+" results found.";return t>0?n:e.staticSuggestions.length?r+" Please select from my Suggestions below.":r+" Please try again."};var m,E,I,T,b=u(n(33)),w=u(n(155)),C=u(n(416)),x=s(n(417)),N=s(n(24)),A=u(n(303)),O=n(21),k=n(67),M=t.safeDomElementRemove=function(e){"remove"in e&&"function"==typeof e.remove?e.remove():e.parentNode.removeChild(e)},D=t.isValidMessageValue=function(e){return e||!1===e||0===e},B=t.toHyphenCase=function(e){return e.toLowerCase().replace(/(['"`])/g,"").replace(/\s/g,"-")},R=(t.noop=function(){},t.stripHTMLTags=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return(0,b.default)(t,["body","textContent"],"")},t.getWMSearchResult=(m=c(i.mark(function e(t){return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,k.sendWalkMeMessage)({type:N.WALKME_SEARCH,payload:{searchTerm:t}});case 3:return e.abrupt("return",e.sent.map(function(e){return y({},e,{displayName:e.name})}));case 7:e.prev=7,e.t0=e.catch(0);case 10:return e.abrupt("return",[]);case 11:case"end":return e.stop()}},e,void 0,[[0,7]])})),function(){return m.apply(this,arguments)})),L=t.resolveBBCodes=(E=c(i.mark(function e(t){return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,k.sendWalkMeMessage)({type:N.RESOLVE_BBCODES,payload:{text:t}});case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0);case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}},e,void 0,[[0,6]])})),function(){return E.apply(this,arguments)});t.extractBBCodesFromText=(I=c(i.mark(function e(){var t,n,r,a,o,s,u,c,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.match(/\[var].+?\[\/var]|\[wm-data].+?\[\/wm-data]|\[jquery].+?\[\/jquery]|\[cookie].+?\[\/cookie]/g)){e.next=4;break}return e.abrupt("return");case 4:n=t.reduce(function(e,t){return y({},e,l({},t,""))},{}),r=!0,a=!1,o=void 0,e.prev=8,s=Object.keys(n)[Symbol.iterator]();case 10:if(r=(u=s.next()).done){e.next=18;break}return c=u.value,e.next=14,L(c);case 14:n[c]=e.sent;case 15:r=!0,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),a=!0,o=e.t0;case 24:e.prev=24,e.prev=25,!r&&s.return&&s.return();case 27:if(e.prev=27,!a){e.next=30;break}throw o;case 30:return e.finish(27);case 31:return e.finish(24);case 32:return e.abrupt("return",n);case 33:case"end":return e.stop()}},e,void 0,[[8,20,24,32],[25,,27,31]])})),function(){return I.apply(this,arguments)}),t.getInitialWMSearchResult=(T=c(i.mark(function e(){var t,n,o,s,u;return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=R(""),n=R(" "),e.next=4,r.all([t,n]);case 4:return s=[].concat(d((o=e.sent)[0]),d(o[1])),u=new Map,s.forEach(function(e){u.set(e.id,e)}),e.abrupt("return",a(u.values()));case 9:case"end":return e.stop()}},e,void 0)})),function(){return T.apply(this,arguments)}),t.suggestionsSorter=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments[2];return String(arguments[1].displayName).localeCompare(String(t.displayName))*e},t.nodeHasSuggestions=function(e){var t=e.suggestions,n=e.staticSuggestions;return Boolean(t&&t.length||n&&n.length)}}).call(this,n(4).assign,n(18).Promise,n(38).from,n(4).entries,n(35))},414:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(180),o=r(n(415)),i=r(n(440)),s=r(n(441)),u=r(n(442)),c=r(n(443)),d=r(n(444)),l=r(n(445)),f=r(n(446));t.default=(0,a.combineReducers)({messages:o.default,settings:i.default,conversation:s.default,suggestions:u.default,dialog:c.default,loader:d.default,analytics:l.default,salesforce:f.default})},415:function(e,t,n){"use strict";(function(e,r){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var s,u=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=n(307),d=(s=c)&&s.__esModule?s:{default:s},l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),f=n(41),p=t.initialState=[];t.default=(0,f.createReducer)(p,(a(i={},l.GET_BOT_DATA_SUCCESS,function(e,t){var n=t.settings;return t.addInitialMessageToChat?[].concat(o(e),[{text:(0,d.default)(n.initialMessages),options:{isUserMessage:!1,timestamp:Date.now()}}]):e}),a(i,l.ADD_MESSAGE,function(e,t){var n=t.message;return[].concat(o(e),[n])}),a(i,l.ADD_IDS_TO_LAST_MESSAGE,function(e,t){var n=t.id,r=t.nodeId;return e.map(function(t,a){return a===e.length-1?u({},t,{options:u({},t.options,{id:n,nodeId:r})}):t})}),a(i,l.REMOVE_ANSWER_SUCCESS,function(e,t){var n=t.id,r=t.nodeId,a=e.findIndex(function(e){var t=e.options;return t.id===n&&t.nodeId===r});return e.slice(0,a-1)}),a(i,l.FINISH_CONVERSATION,function(e){return e.map(function(e){return u({},e,{options:{isUserMessage:e.options.isUserMessage,isSeparator:e.options.isSeparator,success:e.options.success,isRichMessage:e.options.isRichMessage,timestamp:e.options.timestamp}})})}),a(i,l.ADD_SEPARATOR,function(e,t){var n=t.separator;return[].concat(o(t.isNewSeparator?e.filter(function(e){return e.text!==n}):e),[{options:{isSeparator:!0},text:n}])}),a(i,l.SET_FORM_FIELD_VALUE,function(e,t){var n=t.nodeId,r=t.value;return e.map(function(t,a){return e.length-1>a?t:u({},t,{form:t.form&&u({},t.form,{inputs:t.form.inputs&&t.form.inputs.map(function(e){return e.nodeId===n?u({},e,{value:r}):e})})})})}),a(i,l.RESTORE_DIALOG_SUCCESS,function(e,t){return[].concat(o((0,f.mapRestoredDialogToMessages)(t.messages,t.defaultLabels,t.mentionData)))}),a(i,l.ADD_BOT_SETTINGS,function(){return p}),a(i,l.FLUSH_STORE,function(){return p}),i))}).call(this,n(4).assign,n(38).from)},440:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=e.nodes.reduce(function(e,t){return s({},e,r({},t.id,t))},{});return s({},e,{nodesMap:t,form:function(e,t){if(!e.isForm)return null;var n=e.entryPointId;if(!n||!t[n])return null;for(var r=[];n&&t[n]&&t[n].type!==l.CONVERSATION_NODE_TYPES.question;)n=t[n].nextConversationNodeId;for(;n&&t[n]&&t[n].type===l.CONVERSATION_NODE_TYPES.question;){var a=t[n],o=a.dataType;a.isSuggestionsOnly?o===l.QUESTION_DATA_TYPES.text&&(o=l.FORM_INPUT_TYPES.choice):(o===l.QUESTION_DATA_TYPES.choice||o===l.QUESTION_DATA_TYPES.text&&a.suggestions&&a.suggestions.length>0)&&(o=l.FORM_INPUT_TYPES.autocomplete),r.push({nodeId:n,type:o,name:a.name,label:a.text,placeholder:"<"+a.text+">",suggestions:a.suggestions}),n=a.nextConversationNodeId}return 0===r.length?null:{entryNodeId:r[0].nodeId,inputs:r}}(e,t)})}var o;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var i,s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(33),c=(i=u)&&i.__esModule?i:{default:i},d=n(41),l=n(21),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),p=t.initialState={apiBaseUrl:null,walkmeEndUserId:null,jwt:null,uuid:null,botId:null,conversationId:null,name:"",botCustomStyles:[],botActiveCustomStyle:null,initialMessages:[],noMatchedConversationErrorMessages:[],conversations:[],conversationsNodesMap:{},allConversations:[],suggestedConversations:[],fallbackConversations:[],calculateScroll:0,buttonSendText:null,buttonStartOverText:null,conversationUnpublishedText:null,conversationUpdatedText:null,doneText:null,noConversationsOneSearchItemFoundText:null,severalConversationsFoundText:null,suggestionsText:null,chatInputPlaceholderText:null,disabledInputText:null,separatorNewText:null,separatorTodayText:null,separatorYesterdayText:null,separatorCompletedText:null,isSuggestedConversationsOnly:!1,forceUpdate:!1,additionalSettings:{playMode:!1,previewEntityType:null},singleConversationPlayed:!1,liveChat:{enabledGlobal:!1,enabled:!1,suggestionText:null,failsBeforeTrigger:null,alwaysShowButton:!1,temporaryDisabled:!1,buttonLiveChatText:""},siteConfig:null,globalConfig:null,visibility:!0,failsBeforeFallbackSuggested:null};t.default=(0,d.createReducer)(p,(r(o={},f.TRY_INIT_SESSION,function(e,t){return s({},e,{userGuid:t.userGuid,walkmeEndUserId:t.walkmeEndUserId})}),r(o,f.ADD_BOT_SETTINGS,function(e,t){return s({},e,{botId:t.botId,conversationId:t.conversationId,additionalSettings:t.additionalSettings||p.additionalSettings,forceUpdate:t.forceUpdate,botCustomStyles:[],botActiveCustomStyle:null})}),r(o,f.GET_BOT_DATA_FAIL,function(e){return s({},e,{botId:null})}),r(o,f.GET_BOT_CONVERSATIONS_FAIL,function(e){return s({},e,{botId:null})}),r(o,f.INIT_SESSION_SUCCESS,function(e,t){return s({},e,{jwt:t.jwt,uuid:t.uuid,siteConfig:t.siteConfig,globalConfig:t.globalConfig})}),r(o,f.GET_BOT_DATA_SUCCESS,function(e,t){var n=t.settings,r=n.name,a=n.initialMessages,o=n.noMatchedConversationErrorMessages,i=n.suggestedConversations,u=n.fallbackConversations,d=n.buttonSendText,f=n.buttonStartOverText,p=n.buttonLiveChatText,v=n.conversationUnpublishedText,g=n.conversationUpdatedText,h=n.doneText,S=n.noConversationsOneSearchItemFoundText,y=n.severalConversationsFoundText,_=n.suggestionsText,m=n.chatInputPlaceholderText,E=n.disabledInputText,I=n.separatorNewText,T=n.separatorTodayText,b=n.separatorYesterdayText,w=n.separatorCompletedText,C=n.isSuggestedConversationsOnly,x=n.liveChatSuggestionText,N=n.liveChatEnabled,A=n.failsBeforeLiveChatTriggered,O=n.alwaysShowLiveChatButton,k=n.failsBeforeFallbackSuggested,M=n.isWalkMeSearchEnabled,D=n.isWalkMeSearchItemsSuggestedInitially,B=n.botCustomStyles;return B||(B=[{botId:e.botId,active:!0,botDesignId:1,css:(0,c.default)(n,"styles","")}]),s({},e,{forceUpdate:!1,name:r,botCustomStyles:B,botActiveCustomStyle:(B||[]).find(function(e){return e.active})||l.DEFAULT_THEME,initialMessages:a,noMatchedConversationErrorMessages:o,suggestedConversations:i,fallbackConversations:u,buttonSendText:d,buttonStartOverText:f,conversationUnpublishedText:v,conversationUpdatedText:g,doneText:h,noConversationsOneSearchItemFoundText:S,severalConversationsFoundText:y,suggestionsText:_,chatInputPlaceholderText:m,disabledInputText:E,separatorNewText:I,separatorTodayText:T,separatorYesterdayText:b,separatorCompletedText:w,isSuggestedConversationsOnly:C,liveChat:{enabledGlobal:(0,c.default)(e,["siteConfig","Settings","liveChat","isEnabled"],!1),enabled:N,temporaryDisabled:!1,suggestionText:x,failsBeforeTrigger:A,alwaysShowButton:O,buttonLiveChatText:p},failsBeforeFallbackSuggested:k,isWalkMeSearchEnabled:M,isWalkMeSearchItemsSuggestedInitially:D})}),r(o,f.GET_BOT_CONVERSATIONS_SUCCESS,function(e,t){var n=t.conversations;return s({},e,{conversations:n,conversationsNodesMap:n?n.reduce(function(e,t){return s({},e,r({},t.id,a(t)))},{}):{}})}),r(o,f.GET_BOT_ALL_CONVERSATIONS_SUCCESS,function(e,t){return s({},e,{allConversations:t.allConversations})}),r(o,f.RECALCULATE_SCROLL,function(e){return s({},e,{calculateScroll:e.calculateScroll+1})}),r(o,f.PASS_ENV_ID,function(e,t){return s({},e,{envId:t.envId})}),r(o,f.PASS_END_USER_ID,function(e,t){return s({},e,{walkmeEndUserId:t.walkmeEndUserId})}),r(o,f.PASS_IS_WORKSTATION,function(e,t){return s({},e,{isWorkstation:t.isWorkstation})}),r(o,f.PASS_API_BASE_URL,function(e,t){return s({},e,{apiBaseUrl:t.apiBaseUrl})}),r(o,f.CREATE_DIALOG_SUCCESS,function(e){return s({},e,{singleConversationPlayed:!0})}),r(o,f.FLUSH_STORE,function(e,t){var n=(0,c.default)(t,"isChatNeedDestroy",!1);return s({},e,{singleConversationPlayed:n})}),r(o,f.DISABLE_LIVE_CHAT,function(e){return s({},e,{liveChat:s({},e.liveChat,{temporaryDisabled:!0})})}),r(o,f.BOT_VISIBILITY,function(e,t){return s({},e,{visibility:t.visibility})}),o))}).call(this,n(4).assign)},441:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(41),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),u=t.initialState={picked:null,currentNode:null,byKeyword:null,conversationStarted:Date.now(),conversationLength:0};t.default=(0,i.createReducer)(u,(r(a={},s.CHOOSE_CONVERSATION_SUCCESS,function(e,t){return o({},e,{picked:t.conversation,byKeyword:t.byKeyword,conversationStarted:Date.now()})}),r(a,s.GET_CONVERSATION_NODE_SUCCESS,function(e,t){return o({},e,{currentNode:t.node,conversationLength:t.incrementCounter?e.conversationLength+1:e.conversationLength})}),r(a,s.FINISH_CONVERSATION,function(){return u}),r(a,s.ADD_BOT_SETTINGS,function(){return u}),r(a,s.FLUSH_STORE,function(){return u}),r(a,s.SET_CURRENT_NODE,function(e,t){var n=t.nodeId;return o({},e,{currentNode:e.picked.nodes.find(function(e){return e.id===n})})}),a))}).call(this,n(4).assign)},442:function(e,t,n){"use strict";(function(e,r){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(41),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),d=t.initialState={items:[],suggestionItems:[],wmSearchItems:[],loading:!1};t.default=(0,u.createReducer)(d,(a(i={},c.GET_SUGGESTIONS_SUCCESS,function(e,t){var n=t.suggestions;return s({},e,{items:[].concat(o(n),o(e.wmSearchItems)),suggestionItems:n,loading:!1})}),a(i,c.GET_WM_SEARCH_SUGGESTIONS_START,function(e){return s({},e,{loading:!0,wmSearchItems:[]})}),a(i,c.GET_WM_SEARCH_SUGGESTIONS_SUCCESS,function(e,t){var n=t.wmSearchItems;return s({},e,{items:[].concat(o(e.suggestionItems),o(n)),wmSearchItems:n,loading:!1})}),a(i,c.GET_REST_SUGGESTIONS_START,function(e){return s({},e,{loading:!0})}),a(i,c.CHOOSE_CONVERSATION_SUCCESS,function(){return d}),a(i,c.ADD_BOT_SETTINGS,function(){return d}),a(i,c.FLUSH_STORE,function(){return d}),i))}).call(this,n(4).assign,n(38).from)},443:function(e,t,n){"use strict";(function(e,r){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return r(e)}var i;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=n(41),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),d=t.initialState=null;t.default=(0,u.createReducer)(d,(a(i={},c.CREATE_DIALOG_SUCCESS,function(e,t){return s({},t.dialog)}),a(i,c.DIALOG_DATA_ADDED,function(e,t){var n=t.data,r=Object.keys(n).map(function(e){var t=Number(e);return isNaN(t)?e:t});return e.dataKeysSequence&&e.dataKeysSequence.length&&(r=[].concat(o(e.dataKeysSequence.filter(function(e){return!n.hasOwnProperty(e)})),o(r))),s({},e,{dataKeysSequence:r,data:s({},e.data,n)})}),a(i,c.DIALOG_TRUNCATE_DATA_SEQUENCE,function(e,t){var n=e.data,r=void 0===n?{}:n,o=e.dataKeysSequence,i=void 0===o?[]:o,u=i.findIndex(function(e){return e===t.dataKey}),c=-1===u?i:i.slice(0,u);return s({},e,{dataKeysSequence:c,data:c.reduce(function(e,t){return r.hasOwnProperty(t)?s({},e,a({},t,r[t])):e},{})})}),a(i,c.FINISH_CURRENT_DIALOG_SUCCESS,function(){return d}),a(i,c.ADD_BOT_SETTINGS,function(){return d}),a(i,c.FLUSH_STORE,function(){return d}),a(i,c.SUBMIT_FORM_DATA,function(e,t){return s({},e,{data:s({},e.data,t.values)})}),a(i,c.SET_FORM_ERRORS,function(e,t){return s({},e,{invalidFields:t.invalidFields})}),i))}).call(this,n(4).assign,n(38).from)},444:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),s=n(41),u=t.initialState={isBotThinking:!1,isBotWaitForAnswer:!0,insideForm:!1};t.default=(0,s.createReducer)(u,(r(a={},i.INSIDE_FORM,function(e,t){return o({},e,{insideForm:t.insideForm})}),r(a,i.BOT_STATUS,function(e,t){return o({},e,{isBotThinking:t.isBotThinking})}),r(a,i.CHANGE_INPUT_FOCUS,function(e,t){return o({},e,{isBotWaitForAnswer:t.isBotWaitForAnswer})}),r(a,i.FINISH_CONVERSATION,function(e){return o({},e,{isBotThinking:!1})}),r(a,i.ADD_BOT_SETTINGS,function(){return u}),r(a,i.FLUSH_STORE,function(){return u}),a))}).call(this,n(4).assign)},445:function(e,t,n){"use strict";(function(e){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),s=n(41),u=t.initialState={retriesConversationSearch:0,retriesAnswerQuestion:0,searchTerm:null};t.default=(0,s.createReducer)(u,(r(a={},i.ANALYTICS_CONVERSATION_SEARCH_TRY,function(e,t){return o({},e,{retriesConversationSearch:e.retriesConversationSearch+1,searchTerm:t.searchTerm})}),r(a,i.CHOOSE_CONVERSATION_SUCCESS,function(e){return o({},e,{retriesConversationSearch:0,searchTerm:null})}),r(a,i.ANALYTICS_ANSWER_QUESTION_TRY,function(e){return o({},e,{retriesAnswerQuestion:e.retriesAnswerQuestion+1})}),r(a,i.FINISH_CONVERSATION,function(e){return o({},e,{retriesAnswerQuestion:0})}),r(a,i.GET_CONVERSATION_NODE_SUCCESS,function(e){return o({},e,{retriesAnswerQuestion:0})}),r(a,i.ADD_BOT_SETTINGS,function(){return u}),r(a,i.FLUSH_STORE,function(){return u}),a))}).call(this,n(4).assign)},446:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a;Object.defineProperty(t,"__esModule",{value:!0}),t.initialState=void 0;var o=n(41),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),s=n(21),u=(n(447),t.initialState={oauthUrl:"",salesforceState:s.SalesforceRunningState.CANCELED});t.default=(0,o.createReducer)(u,(r(a={},i.REQUESTING_SALESFORCE,function(e,t){return t}),r(a,i.FLUSH_STORE,function(){return u}),a))},447:function(){"use strict"},448:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){var n,s=this,u=null,c=!1;t.subscribe((n=r.mark(function e(){var n,o,i,d;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.getState(),i=(o=n.settings).botId,d=o.forceUpdate,!o.jwt||!i){e.next=8;break}if(u!==i&&(u=i,t.dispatch((0,a.loadBotData)(i,!0))),!d||c){e.next=8;break}return c=!0,e.next=7,t.dispatch((0,a.loadBotData)(i,!0));case 7:c=!1;case 8:u=i;case 9:case"end":return e.stop()}},e,s)}),function(){var t=n.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})}));var d=t.subscribe(function(){var e=t.getState(),n=e.messages,r=e.dialog,a=e.settings,s=a.botId,u=a.name;r&&r.isRestored&&d(),n&&n.length&&n.some(function(e){return e.options.isUserMessage})&&((0,i.sendAnalyticsEvent)(o.ANALYTICS_EVENTS.endUserEngaged,{type:"actionBotBot",oId:s,oName:u}),d())})};var a=n(152),o=n(21),i=n(67)}).call(this,n(18).Promise,n(35))},449:function(e,t,n){"use strict";(function(e,r,a){function o(e,t){return Number(e&&e.initialSize&&e.initialSize[t])||l}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.changeHeaderHeight=function(e){var t=window.parent.document.querySelector("."+p.dragHeader.className);t&&(t.style.height=e+"px")};var s,u=n(450),c=(s=u)&&s.__esModule?s:{default:s},d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),l=320,f={topEdge:{className:"wm-top-edge",styles:{zIndex:10,width:"100%",height:"4px",position:"absolute",top:0,left:0,cursor:"ns-resize"}},bottomEdge:{className:"wm-bottom-edge",styles:{zIndex:10,width:"100%",height:"4px",position:"absolute",bottom:0,left:0,cursor:"ns-resize"}},rightEdge:{className:"wm-right-edge",styles:{zIndex:10,width:"4px",height:"100%",position:"absolute",top:0,right:0,cursor:"ew-resize"}},leftEdge:{className:"wm-left-edge",styles:{zIndex:10,width:"4px",height:"100%",position:"absolute",top:0,left:0,cursor:"ew-resize"}},rightTopEdge:{className:"wm-right-top-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",top:"2px",right:"2px",cursor:"nesw-resize"}},leftTopEdge:{className:"wm-left-top-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",top:"2px",left:"2px",cursor:"nwse-resize"}},rightBottomEdge:{className:"wm-right-bottom-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",bottom:"2px",right:"2px",cursor:"nwse-resize"}},leftBottomEdge:{className:"wm-left-bottom-edge",styles:{zIndex:15,width:"10px",height:"10px",position:"absolute",bottom:"2px",left:"2px",cursor:"nesw-resize"}}},p={dragHeader:{className:"wm-drag-header",styles:{position:"absolute",top:0,left:0,height:"57px",width:"85%",zIndex:9,cursor:"move"}}};t.default=function t(n,s){var u=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialize=function(){if(u.isMobileBrowser)u._node.style.width="100%",u._node.style.height="100%";else{var e=!0;u.globalConfig&&!1===u.globalConfig.resizable&&(e=!1),u.applyInitialPosition(),e&&(u.findChildIframes(),u.createEdgeElements())}},this.applyInitialPosition=function(){var e=parseInt(document.defaultView.getComputedStyle(u._node).width,10),t=parseInt(document.defaultView.getComputedStyle(u._node).height,10),n=window.innerWidth/2-e/2,a=window.innerHeight/2-t/2;if(u.globalConfig&&u.globalConfig.initialPosition){var o=u.globalConfig.initialPosition,i=o.top,s=o.left;i&&(a=Number(i)),s&&(n=Number(s))}r(u._node.style,{margin:"inherit",top:a+"px",left:n+"px",bottom:"auto",right:"auto"})},this.createNodeElements=function(e,t){return a(e).map(function(e){var n=i(e,2),a=n[0],o=n[1],s=document.createElement("div");return s.className=o.className,s.dataset[t]=a,r(s.style,o.styles),s})},this.createEdgeElements=function(){var e=document.createDocumentFragment();u.createNodeElements(f,"edge").forEach(function(t){t.addEventListener("mousedown",u.mouseDownHandler),e.appendChild(t)}),u.createNodeElements(p,"drag").forEach(function(t){t.addEventListener("mousedown",u.dragHandler),t.addEventListener("dblclick",u.dblClickHandler),e.appendChild(t)}),u._node.appendChild(e)},this.mouseDownHandler=function(e){var t=e.target.dataset.edge,n="resize"+t[0].toUpperCase()+t.slice(1);"function"==typeof u[n]&&(u._mouseMoveHandlerNames.push(n),u.changeVisibilityChildIframes("none"),u._isFullScreen=!1,u._startX=e.clientX,u._startY=e.clientY,u._startWidth=parseInt(document.defaultView.getComputedStyle(u._node).width,10),u._startHeight=parseInt(document.defaultView.getComputedStyle(u._node).height,10),document.documentElement.addEventListener("mousemove",u[n]),document.documentElement.addEventListener("mouseup",u.stopResize))},this.dragHandler=function(e){u.changeVisibilityChildIframes("none");var t=parseInt(document.defaultView.getComputedStyle(u._node).left,10),n=parseInt(document.defaultView.getComputedStyle(u._node).top,10);u._windowWidth=window.innerWidth,u._windowHeight=window.innerHeight,u._startWidth=parseInt(document.defaultView.getComputedStyle(u._node).width,10),u._startHeight=parseInt(document.defaultView.getComputedStyle(u._node).height,10),u._leftPosition=e.clientX-t,u._topPosition=e.clientY-n,document.documentElement.addEventListener("mousemove",u.dragMove),document.documentElement.addEventListener("mouseup",u.stopDrag)},this.dblClickHandler=function(){if(u._isFullScreen)r(u._node.style,u._prevScreenState),u._isFullScreen=!1;else{var e=u._node.style;u._prevScreenState={width:e.width,height:e.height,top:e.top,left:e.left},r(u._node.style,{width:"100%",height:"100%",top:0,left:0}),u._isFullScreen=!0}u._view.emitInside({type:d.RECALCULATE_SCROLL})},this.dragMove=function(e){var t=e.clientX-u._leftPosition,n=u._windowWidth-u._startWidth/2,r=0-u._startWidth/2,a=u.getAvailablePosition(e.clientY-u._topPosition,0,u._windowHeight-u._startHeight/2),o=u.getAvailablePosition(t,r,n);u._node.style.top=a+"px",u._node.style.left=o+"px"},this.getAvailablePosition=function(e,t,n){return e>t?e>t&&n>=e?e:n:t},this.resizeLeftEdge=function(e){var t=u._startWidth+u._startX-e.clientX;t>u.minWidth?(u._node.style.width=t+"px",u._node.style.left=e.clientX+"px"):u._node.style.width=u.minWidth+"px"},this.resizeRightEdge=function(e){var t=u._startWidth+e.clientX-u._startX;u._node.style.width=(t>u.minWidth?t:u.minWidth)+"px"},this.resizeTopEdge=function(e){var t=u._startHeight+u._startY-e.clientY;t>u.minHeight?(u._node.style.height=t+"px",u._node.style.top=e.clientY+"px"):u._node.style.height=u.minHeight+"px"},this.resizeBottomEdge=function(e){var t=u._startHeight+e.clientY-u._startY;u._node.style.height=(t>u.minHeight?t:u.minHeight)+"px"},this.resizeRightTopEdge=function(e){u.resizeRightEdge(e),u.resizeTopEdge(e)},this.resizeLeftTopEdge=function(e){u.resizeLeftEdge(e),u.resizeTopEdge(e)},this.resizeRightBottomEdge=function(e){u.resizeRightEdge(e),u.resizeBottomEdge(e)},this.resizeLeftBottomEdge=function(e){u.resizeLeftEdge(e),u.resizeBottomEdge(e)},this.findChildIframes=function(){u._iframes=[].concat(function(t){if(Array.isArray(t)){for(var n=0,r=Array(t.length);t.length>n;n++)r[n]=t[n];return r}return e(t)}(u._node.querySelectorAll("iframe")))},this.changeVisibilityChildIframes=function(e){var t=e;u._iframes.forEach(function(e){r(e.style,{pointerEvents:t})})},this.stopResize=function(){u.changeVisibilityChildIframes("auto"),u._mouseMoveHandlerNames.forEach(function(e){document.documentElement.removeEventListener("mousemove",u[e])})},this.stopDrag=function(){u.changeVisibilityChildIframes("auto"),document.documentElement.removeEventListener("mousemove",u.dragMove)},this._view=n,this._node=n._wmBotContainer,this.minWidth=o(s,"minWidth"),this.minHeight=o(s,"minHeight"),this.isMobileBrowser=c.default,this.globalConfig=s,this._mouseMoveHandlerNames=[],this._isFullScreen=!1,this._prevScreenState={},this.initialize()}}).call(this,n(38).from,n(4).assign,n(4).entries)},450:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=(n=navigator.userAgent||navigator.vendor||window.opera,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)));t.default=r},67:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.registerConnection=function(){window.onWalkMeMessage=function(e){var t=e.type,n=e.payload;t===u.INIT_MESSAGE_FUNC&&"function"==typeof n.func?d=n.func:i.default.dispatch(t===u.TRY_INIT_SESSION?(0,s.initSession)(n.userGuid,n.walkmeEndUserId,n.uuid,n.siteConfig,n.globalConfig,n.clientSideSFOauth):e)}},t.sendWalkMeMessage=function(t){return new e(function(e,n){try{var a=t.payload;a?r(a,{resolve:e,reject:n}):r(t,{payload:{resolve:e,reject:n}}),d(t)}catch(e){n(e)}})},t.sendAnalyticsEvent=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t;l()&&r&&r.value&&(r.value="#####"),d({type:u.BOT_ANALYTICS_EVENT,payload:{type:e,data:r,options:n}})};var a,o=n(126),i=(a=o)&&a.__esModule?a:{default:a},s=n(152),u=n(24),c=n(21),d=void 0,l=function(){var e=i.default.getState().conversation;return e&&e.picked&&e.picked[c.CLIENT_SIDE_MODE]}}).call(this,n(18).Promise,n(4).assign)},774:function(e,t,n){"use strict";(function(e,r){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=a(n(789)),s=a(n(236)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),c=a(n(449)),d=function(){function t(){var n,a,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.init=(n=r.mark(function e(t){var n,a=t.userGuid,d=t.walkmeEndUserId,l=t.envId,f=t.uuid,p=t.apiBaseUrl,v=t.publicPath,g=t.siteConfig,h=t.isWorkstation,S=t.walkmeOpenUrl,y=t.clientSideSFOauth,_=t.evaluateTagsById,m=t.globalConfig;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o._view?o._view.update({userGuid:a,walkmeEndUserId:d,uuid:f,apiBaseUrl:p,publicPath:v,siteConfig:g,globalConfig:m}):(o._view=new i.default({userGuid:a,walkmeEndUserId:d,uuid:f,apiBaseUrl:p,publicPath:v,siteConfig:g,clientSideSFOauth:y,globalConfig:m}),o._bindViewEvents()),e.next=3,o._view.init();case 3:return n=e.sent,o._container=new c.default(o._view,m),o._view.emitInside({type:u.PASS_ENV_ID,payload:{envId:l}}),o._view.emitInside({type:u.PASS_END_USER_ID,payload:{walkmeEndUserId:d}}),o._view.emitInside({type:u.PASS_IS_WORKSTATION,payload:{isWorkstation:h}}),s.default.init({walkmeOpenUrl:S,evaluateTagsById:_}),e.abrupt("return",n);case 10:case"end":return e.stop()}},e,o)}),a=function(){var t=n.apply(this,arguments);return new e(function(n,r){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void r(e)}if(!s.done)return e.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});n(u)}("next")})},function(){return a.apply(this,arguments)}),this.open=function(e){return o._view.open(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},this.show=function(){return o._view.show()},this.hide=function(){return o._view.hide()},this.emitInside=function(){var e;return(e=o._view).emitInside.apply(e,arguments)},this.close=function(){o._view&&o._view.destroy()},this.on=function(e,t){return o._view.on(e,t)},this.off=function(e,t){return o._view.removeListener(e,t)},this.emit=function(e){return o._view.emitInside(e)}}return o(t,[{key:"_bindViewEvents",value:function(){if(!this._view)throw new Error("Invalid view");this._view.on(u.BOT_HIDE,this.hide),this._view.on(u.BOT_SHOW,this.show)}}]),t}();t.default=d}).call(this,n(18).Promise,n(35))},78:function(e,t,n){"use strict";(function(e,r,a,o){function i(e){return e&&e.__esModule?e:{default:e}}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);e.length>t;t++)n[t]=e[t];return n}return a(e)}function u(e){return function(){var t=e.apply(this,arguments);return new o(function(e,n){return function r(a,i){try{var s=t[a](i),u=s.value}catch(e){return void n(e)}if(!s.done)return o.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var c,d,l=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=(c=u(r.mark(function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.default.get("/oauth2/pingToken",{timeout:7e4});case 3:e.next=15;break;case 5:if(e.prev=5,e.t0=e.catch(0),t=Date.now()-n,!(I>t&&e.t0.response&&e.t0.response.data&&401===e.t0.response.data.status&&"no token matching request"===e.t0.response.data.message)){e.next=14;break}return e.next=11,E(5e3);case 11:return e.next=13,f(n);case 13:return e.abrupt("return");case 14:throw e.t0;case 15:case"end":return e.stop()}},e,this,[[0,5]])})),function(){return c.apply(this,arguments)}),p=i(n(393)),v=i(n(33)),g=i(n(126)),h=n(322),S=n(21),y=function(){g.default.getState().salesforce.salesforceState!==S.SalesforceRunningState.RUNNING&&g.default.dispatch((0,h.changeRequestingSalesforce)(S.SalesforceRunningState.RUNNING))},_=p.default.CancelToken,m=_.source(),E=function(e){return new o(function(t){return setTimeout(function(){return t()},e)})},I=36e4,T=(d=u(r.mark(function e(t){for(var n=arguments.length,a=Array(n>1?n-1:0),i=1;n>i;i++)a[i-1]=arguments[i];var u,c=t.method,d=t.retry,l=void 0===d||d;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.default[c].apply(p.default,s(a));case 3:return u=e.sent,y(),e.abrupt("return",u);case 8:if(e.prev=8,e.t0=e.catch(0),"need access token for salesforce"!==(0,v.default)(e.t0,["response","data","message"])||!l){e.next=15;break}return t=(0,v.default)(e.t0,["response","data","data","salesforceOauthUrl"]),g.default.getState().salesforce.salesforceState!==S.SalesforceRunningState.WAITING&&g.default.dispatch((0,h.changeRequestingSalesforce)(S.SalesforceRunningState.WAITING,t)),e.next=14,f();case 14:return e.abrupt("return",T.apply(void 0,[{method:c,retry:!1}].concat(s(a))));case 15:return y(),e.abrupt("return",o.reject(e.t0));case 17:case"end":return e.stop()}var t},e,void 0,[[0,8]])})),function(){return d.apply(this,arguments)}),b=function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return T.apply(void 0,[{method:e}].concat(n))}},w={get:b("get"),post:b("post"),put:b("put"),delete:b("delete")};p.default.interceptors.request.use(function(t){var n=g.default.getState().settings,r=n.jwt,a=n.envId,o=n.apiBaseUrl;if(r&&Number.isFinite(a)){var i=l({},t.headers,{Authorization:"Bearer "+r,"x-wmab-wmenv":a,"x-wmab-utc-offset":(new Date).getTimezoneOffset(),Pragma:"no-cache"});e(t,{headers:i,cancelToken:m.token})}return o&&e(t,{url:o+t.url}),t},o.reject);var C,x=function(){m.cancel('Request was canceled by Cancel token. Reason: "'+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unknown reason")+'"')},N=(C=u(r.mark(function e(t,n,a,i){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",w.get("/bots/"+t+"/conversations/"+n+"/dialogs/"+a+"/nodes/"+i+"/suggestions").catch(function(e){var r=(0,v.default)(e,["response","status"]);return[500,504].includes(r)?N(t,n,a,i):o.reject(e)}));case 1:case"end":return e.stop()}},e,void 0)})),function(){return C.apply(this,arguments)});t.default={setNewCancelToken:function(){x("New token generated"),m=_.source()},cancelAllRequests:x,isCanceled:function(e){return p.default.isCancel(e)},fetchJWT:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.clientSideSFOauth&&(p.default.defaults.withCredentials=!0),w.post("/init",e)},fetchBotData:function(e){return w.get("/bots/"+e)},sendUserMessage:function(e){return w.post("/v1/bots/"+e.botId+"/conversations/"+e.conversationId+"/dialogs/"+e.dialogId+"/messages",{nodeId:e.nodeId,text:e.text})},postNode:function(e){return w.post("/bots/"+e.botId+"/conversations/"+e.conversationId+"/nodes/"+e.nodeId,{dialog:e.dialog})},postConnectionMessage:function(e){return w.post("/bots/"+e.botId+"/conversations/"+e.conversationId+"/messages",{text:e.text,nodeId:e.nodeId,dialog:e.dialog})},getConversation:function(e,t){return w.get("/bots/"+e+"/conversations/"+t)},getConversations:function(e,t){return w.get("/bots/"+e+"/conversations",{params:{text:t}})},getFirstConversationNode:function(e,t,n,r){return w.get("/bots/"+e+"/conversations/"+t+"/dialogs/"+n+"/nodes/first",r?{params:r}:void 0)},getNextConversationNode:function(e,t,n,r,a){return w.get("/bots/"+e+"/conversations/"+t+"/dialogs/"+n+"/nodes/"+r,a?{params:a}:void 0)},createDialog:function(e,t){return w.post("/bots/"+e+"/conversations/"+t+"/dialogs")},getDialog:function(e,t,n){return w.get("/bots/"+e+"/conversations/"+t+"/dialogs/"+n)},restoreDialog:function(e,t){return w.get("/bots/"+e+"/dialogs/restore",{params:l({},t&&{conversationId:t}),timeout:3e3})},finishDialog:function(e,t,n){return w.put("/bots/"+e+"/conversations/"+t+"/dialogs/"+n,{isFinished:!0})},removeAnswer:function(e,t,n,r){return w.delete("/bots/"+e+"/conversations/"+t+"/dialogs/"+n+"/messages/"+r)},getRestSuggestions:N}}).call(this,n(4).assign,n(35),n(38).from,n(18).Promise)},789:function(e,t,n){"use strict";(function(e,r,a){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){var t=e.apply(this,arguments);return new r(function(e,n){return function a(o,i){try{var s=t[o](i),u=s.value}catch(e){return void n(e)}if(!s.done)return r.resolve(u).then(function(e){a("next",e)},function(e){a("throw",e)});e(u)}("next")})}}Object.defineProperty(t,"__esModule",{value:!0});var s=e||function(e){for(var t=1;arguments.length>t;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=o(n(790)),d=o(n(93)),l=o(n(124)),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(24)),p=n(21),v=n(386),g=n(41),h={position:"fixed",width:"100%",height:"100%",top:0,left:0,pointerEvents:"none",zIndex:9999999999},S={position:"absolute",height:"550px",width:25*(window&&window.innerWidth||1)>400?"400px":"25%",minWidth:"320px",top:0,left:0,bottom:0,right:0,margin:"auto",borderRadius:"4px",boxShadow:"0px 2px 15px #DDE5F5BF",overflow:"hidden",userSelect:"none",pointerEvents:"auto"},y={width:"100%",height:"100%",border:"0",position:"absolute",top:"0",left:"0",display:"block"},_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return m.call(n),n.createOrUpdatePrivates(t),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,c.default),u(e,[{key:"emitInside",value:function(e){this._iframe&&this._iframe.contentWindow&&this._iframe.contentWindow.onWalkMeMessage&&"function"==typeof this._iframe.contentWindow.onWalkMeMessage&&this._iframe.contentWindow.onWalkMeMessage(e)}},{key:"destroy",value:function(){(0,g.safeDomElementRemove)(this._wmBotWrapper),(0,g.safeDomElementRemove)(this._wmBotContainer),this._wmBotWrapper=null,this._wmBotContainer=null,this._iframe=null}}]),e}(),m=function(){var t,o=this;this.update=function(e){o.createOrUpdatePrivates(e)},this.createOrUpdatePrivates=function(e){var t=e.walkmeEndUserId,n=e.uuid,r=e.apiBaseUrl,a=e.publicPath,i=e.siteConfig,s=e.globalConfig,u=e.clientSideSFOauth;o._userGuid=e.userGuid,o._clientSideSFOauth=u,o._walkmeEndUserId=t,o._uuid=n,o._apiBaseUrl=o._getActionBotApiBaseUrl(r),o._publicPath=a,o._siteConfig=i,o._globalConfig=s},this.init=i(a.mark(function t(){var i,u,c,g,_,m,E;return a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Boolean(document.getElementById(p.IFRAME_ID))?o.tryInitSession():(o._wmBotWrapper=document.createElement("div"),o._wmBotWrapper.className=p.WM_WRAPPER_BOT_CLASSNAME+" "+p.WM_WRAPPER_BOT_CLASSNAME+"-latest",e(o._wmBotWrapper.style,h),o._wmBotContainer=document.createElement("div"),o._wmBotContainer.className=p.WM_BOT_CLASSNAME,i=s({},o._globalConfig&&o._globalConfig.initialSize&&s({},o._globalConfig.initialSize)),e(o._wmBotContainer.style,S,i),o._iframe=document.createElement("iframe"),o._iframe.id=p.IFRAME_ID,o._iframe.setAttribute("title","WalkMe ActionBot"),e(o._iframe.style,y),u=window,g=(c=u._walkmeExtension)&&c.nonceValue||"",_=window.document.documentElement.lang||"",m='\n      <head>\n          <link href="'+o._publicPath+"chat."+n.h+'.css" rel="stylesheet">\n      </head>\n      <body style="margin: 0" lang="'+_+'">\n          <div id="root"></div>\n      </body>\n    ',o._wmBotContainer.appendChild(o._iframe),o._wmBotWrapper.appendChild(o._wmBotContainer),(E=d.default.deps.topContainerProvider.getTopContainer())&&E[0]?E[0].appendChild(o._wmBotWrapper):l.default.error(new Error("Can't find top container."),!0),o._iframe.contentWindow.document.write(m),o._iframe.contentWindow.publicPath=o._publicPath,o._iframe.onload=function(){var e=o._iframe.contentWindow.document.createElement("script");e.setAttribute("nonce",g),e.onload=function(){o.emitInside({type:f.INIT_MESSAGE_FUNC,payload:{func:function(e){if(e&&e.type)return o.emit(e.type,e.payload)}}}),o.emitInside({type:f.PASS_API_BASE_URL,payload:{apiBaseUrl:o._apiBaseUrl}}),o.tryInitSession()},e.src=o._publicPath+"chat."+n.h+".js",o._iframe.contentWindow.document.head.appendChild(e)},o._iframe.contentWindow.document.close(),o.hide()),t.abrupt("return",new r(function(e,t){o.on(f.INIT_SESSION_SUCCESS,function(t){(0,v.safeResolve)(t),e(t)}),o.on(f.INIT_SESSION_FAIL,function(e){(0,v.safeResolve)(e),t(e)})}));case 3:case"end":return t.stop()}},t,o)})),this.tryInitSession=function(){o.emitInside({type:f.TRY_INIT_SESSION,payload:{walkmeEndUserId:o._walkmeEndUserId,userGuid:o._userGuid,clientSideSFOauth:o._clientSideSFOauth,uuid:o._uuid,siteConfig:o._siteConfig,globalConfig:o._globalConfig}})},this.open=(t=i(a.mark(function e(t,n){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o.emitInside({type:f.ADD_BOT_SETTINGS,payload:s({},t,{forceUpdate:n})}),e.abrupt("return",new r(function(e,t){o.on(f.BOT_SHOW,e),o.on(f.INITIAL_DATA_LOAD_FAIL,function(){return t(f.INITIAL_DATA_LOAD_FAIL)})}));case 2:case"end":return e.stop()}},e,o)})),function(){return t.apply(this,arguments)}),this.show=function(){o._wmBotWrapper.style.opacity=1,o._wmBotWrapper.style.zIndex=h.zIndex,o._wmBotContainer.style.boxShadow=S.boxShadow,o.emitInside({type:f.BOT_VISIBILITY,payload:{visibility:!0}})},this.hide=function(){o._wmBotWrapper.style.opacity=0,o._wmBotWrapper.style.zIndex="-1",o._wmBotContainer.style.boxShadow="none",o.emitInside({type:f.BOT_VISIBILITY,payload:{visibility:!1}})},this._getActionBotApiBaseUrl=function(e){return e+"/chatbot"}};t.default=_}).call(this,n(4).assign,n(18).Promise,n(35))},79:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(24),o=n(67),i=n(78),s=(r=i)&&r.__esModule?r:{default:r};t.default={error:function(e,t){s.default.isCanceled(e)||(0,o.sendWalkMeMessage)({type:a.SEND_ERROR_TO_LOGZ,payload:{error:e,clientRelated:t}})}}}}]);